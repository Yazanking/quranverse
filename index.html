<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZG5YSD728"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-TZG5YSD728');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Quranic Verse</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- Favicon (ensure the path is correct or use an absolute URL) -->
    <link rel="shortcut icon" type="image/x-icon" href="path/to/your/favicon.ico" />
    <!-- Font and Style Links -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri&family=Roboto&display=swap" rel="stylesheet">
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Random Quranic Verse" />
    <meta property="og:description" content="Explore a random verse from the Quran." />
    <meta property="og:image" content="https://yourwebsite.com/default-image.png" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://yourwebsite.com/" />
    <style>
      /* Remove outline on mouse interactions */
:focus:not(:focus-visible) {
  outline: none;
}

/* Ensure accessibility for keyboard navigation */
:focus-visible {
  outline: 2px solid #61dafb; /* Customize the color to your theme */
  outline-offset: 4px; /* Add spacing if needed */
}
/* Medium Button Styles */
.button.medium,
button.medium,
.popup button.medium,
#exit-button.medium,
.menu-button.medium,
.exit-button.medium,
.menu-item.medium,


/* Hover Effects */
.button:hover,
button:hover,
.popup button:hover,
#exit-button:hover,
.menu-button:hover,
.exit-button:hover,
.menu-item:hover,
.button.medium:hover,
button.medium:hover,
.popup button.medium:hover,
#exit-button.medium:hover,
.menu-button.medium:hover,
.exit-button.medium:hover,
.menu-item.medium:hover,

/* Bookmark Button Specific Styles */
#bookmarkButton img {
  margin-left: 5px;

}

#newVerseButton img {
  margin-left: 5px;

}
#tafsirButton img {
  margin-right: 5px;
  margin-top: 2.5px;

}

/* Bookmark Button Specific Styles */
#bookmarkButton:hover img {
  transform: scale(1.09);

}
/* Bookmark Button Specific Styles */
#newVerseButton:hover img {
  transform: scale(1.09);

}
#bookmarkButtonpopup{
  background-color: white;
}
/* Bookmark Button Specific Styles */
#tafsirButton:hover img {
  transform: scale(1.09);

}
/* Popup Container */
.popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  padding: 24px;
  background-color: #1f1e1e;
  border: 2px solid #646060;
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
  z-index: 1000;
  max-width: 450px;
  text-align: center;
  border-radius: 20px;
}

/* Bookmark Verses Container */
#bookmarkedVersesContainer {
  cursor: pointer;
  max-height: 400px; /* Adjust height */
  overflow-y: auto;
  margin-bottom: 20px;
  padding: 20px;
  background: rgba(30, 24, 24, 0.85); /* Increase opacity for clarity */
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* Subtle shadow for depth */
  border-radius: 10px; /* Modern rounded corners */
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: #fff;
  font-size: 16px; /* Increase font size for readability */
  line-height: 1.6; /* Improve line spacing */
  font-family: 'Roboto', sans-serif; /* Use a clear, sans-serif font */
  -webkit-font-smoothing: antialiased; /* Improve font rendering on WebKit browsers */
  -moz-osx-font-smoothing: grayscale; /* Improve font rendering on macOS */
}


/* Optional: Styling for hover effects */
#bookmarkedVersesContainer:hover {
  background: rgba(30, 24, 24, 0.4); /* Slightly increase opacity on hover */
  box-shadow: 0 10px 40px 0 rgba(31, 38, 135, 0.5); /* Enhance shadow on hover */
}

/* For WebKit browsers (Chrome, Safari) to style scrollbars */
#bookmarkedVersesContainer::-webkit-scrollbar {
  width: 10px; /* Wider scrollbar */
}

#bookmarkedVersesContainer::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.5); /* Color of the scrollbar handle */
  border-radius: 10px; /* Rounded scrollbar handle */
}

#bookmarkedVersesContainer::-webkit-scrollbar-track {
  background: transparent; /* Background of the scrollbar track */
}


/* Bookmarked Verse Styling */
.bookmarkedVerse {
  padding: 20px; /* Increase padding for better readability */
  background: rgba(30, 24, 24, 0.3); /* Glass-like semi-transparent background */
  margin-bottom: 15px; /* More spacing between verses */
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37); /* Deeper shadow for depth */
  border-radius: 12px; /* Larger rounded corners for a modern look */
  border: 1px solid rgba(255, 255, 255, 0.18); /* Subtle border for glass effect */
  text-align: left; /* Keep text alignment */
  line-height: 1.8; /* Slightly increase line height for readability */
  color: #fff; /* Ensure text is readable on the background */
  transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth hover effect */
}

/* Hover effect for bookmarked verses */
.bookmarkedVerse:hover {
  transform: translateY(-5px); /* Lift effect on hover */
  box-shadow: 0 6px 24px rgba(31, 38, 135, 0.5); /* More pronounced shadow */
  background: rgba(30, 24, 24, 0.4); /* Slightly increase opacity */
}


#verse-container {
  position: relative;
  text-align: center;
  padding: 24px;
  background: rgba(30, 24, 24, 0.3); /* Dark semi-transparent background */
  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37); /* Deep soft shadow for depth */
  backdrop-filter: blur(4px); /* Glass-like blur effect */
  -webkit-backdrop-filter: blur(4px); /* Safari support for blur */
  border-radius: 10px; /* Rounded corners */
  border: 1px solid rgba(255, 255, 255, 0.18); /* Subtle border for glass effect */
  transition: box-shadow 0.3s ease-in-out, background 0.3s ease-in-out;
  margin-top: 30px;
  display: inline-block;
  width: auto;
  max-width: 100%;
  color: #fff; /* Text color to contrast the background */
}

/* Optional: Add hover effect for interactivity */
#verse-container:hover {
  background: rgba(30, 24, 24, 0.4); /* Slightly increase opacity on hover */
  box-shadow: 0 10px 40px 0 rgba(31, 38, 135, 0.5); /* Enhance shadow on hover */
}



/* Progress Bar Styling */
#progressBar {
  cursor: pointer;
  width: 100%;
  height: 8px;
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  z-index: 9;
  background: linear-gradient(to right, #ffffff 0%, #ffffff 50%, #ffffff 100%);
  animation: smoothFill 0.4s linear forwards;
  display: none;
  border-radius: 4px;
  overflow: hidden;
}


#progressBar::-webkit-progress-value { background: #ffffff; transition: width 0.3s linear; }
.progress{
  cursor: pointer;
  appearance: auto;
    box-sizing: border-box;
    display: inline-block;
    block-size: 1em;
    inline-size: 10em;
    vertical-align: -0.2em;
}
/* Reciter Dropdown Styling */
#reciterDropdown {
  width: 100%; /* Full width for responsiveness */
  max-width: 400px; /* Limit maximum width for larger screens */
  padding: 12px; /* Increase padding for better usability */
  font-size: 16px; /* Consistent and legible font size */
  border: 1px solid rgba(255, 255, 255, 0.18); /* Subtle border for glass effect */
  border-radius: 10px; /* Larger rounded corners for a smoother look */
  background: rgba(30, 24, 24, 0.3); /* Glass-like background */
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37); /* Subtle shadow for depth */
  color: #fff; /* Ensure text is readable on the background */
  backdrop-filter: blur(6px); /* Glass-like blur effect */
  -webkit-backdrop-filter: blur(6px); /* Safari support for blur */
  margin-bottom: 15px; /* Extra spacing below the dropdown */
  transition: box-shadow 0.3s ease, background 0.3s ease; /* Smooth hover and focus effects */
}

/* Hover effect for the dropdown */
#reciterDropdown:hover {
  background: rgba(30, 24, 24, 0.4); /* Slightly darker background on hover */
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5); /* Enhanced shadow */
}

/* Focus effect for better accessibility */
#reciterDropdown:focus {
  outline: 2px solid rgba(97, 218, 251, 0.8); /* Highlight the dropdown on focus */
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5); /* Same shadow as hover */
}


#reciterDropdown option {
  font-size: 14px; /* Legible font size */
  background: rgba(30, 24, 24, 0.8); /* Semi-transparent glass-like background */
  color: #ffffff; /* High contrast for readability */
  text-align: center; /* Center-align text */
  padding: 8px; /* Add padding for better spacing */
  border-radius: 6px; /* Slight rounding for modern appearance */
}

/* Optional: Hover effect for dropdown options */
#reciterDropdown option:hover {
  background: rgba(31, 38, 135, 0.7); /* Highlighted background color */
  color: #ffffff; /* Keep text color consistent */
}


/* Switch Styling */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  border-radius: 34px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  border-radius: 50%;
  transition: transform 0.4s;
}

input:checked + .slider:before {
  transform: translateX(26px);
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

/* About Container Styling */
.about-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: rgba(0, 0, 0, 0.863);
  color: #fff;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.6);
  z-index: 1000;
  display: none;
}

.about-container p {
  margin-bottom: 15px;
}

body:not(.menu-open) .about-container {
  display: none;
}

/* Verse of the Day Container */
#verse-of-the-day-container {
  display: none;
  text-align: center;
  padding: 20px;
  background-color: rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
  margin-top: 20px;
}

.menu-middle {
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.instagram-container {
  margin-top: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.instagram-container img {
  width: 30px;
  height: 30px;
  border: 0;
  margin-right: 10px;
}

.dark-theme {
  background-color: #111;
  color: #fff;
}

.dark-theme h1,
.dark-theme p,
.dark-theme #verse-container {
  color: #ffffff;
  background-color: rgba(255, 255, 255, 0.178);
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
}

/* Responsive Design Adjustments */
@media (max-width: 767px) {
  #verse-container {
    padding: 10px;
  }

  #verse {
    font-size: 1.2em;
  }
}

@media (min-width: 768px) and (max-width: 1199px) {
  #verse-container {
    padding: 15px;
  }
}

@media (min-width: 1200px) {
  #verse-container {
    margin-top: 100px;
  }
}

body {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
  margin: 0;
  background-image: url('https://winstonchurchill.hillsdale.edu/wp-content/uploads/2016/03/3855627586_4db6944f4e_o-840x430.jpg');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
  color: #ffffff;
  transition: background-color 0.3s ease-in-out;
}

h1 {
  font-size: 2em;
  margin-bottom: 10px;
  transition: color 0.3s ease-in-out;
  position: absolute;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 2;
}

p {
  font-size: 1.2em;
  line-height: 1.6;
  transition: color 0.3s ease-in-out;
  text-align: center;
}

#verse {
  font-family: 'Arial ', 'Arial ', Arial ; /* Fall back to a generic serif if unavailable */
  font-size: 2em; /* Adjust size as needed */
  line-height: 1.8; /* Improve readability */
  direction: rtl; /* Ensure proper Arabic text flow */
  margin-bottom: 5px;
  background-color: transparent;
  color: #fff;
  transition: font-size 0.5s ease-in-out, color 0.5s ease-in-out;
}

#translation,
#second-translation {
  display: block;
  max-height: 0;
  opacity: 0;
  overflow: hidden;
  transition: max-height 0.5s ease, opacity 0.5s ease;
}

#translation.show,
#second-translation.show {
  max-height: 1000px;
  opacity: 1;
}

#verse, #translation {
  line-height: 1.8;
  margin-bottom: 1em;
}

p {
  margin: 0.5em 0;
}

#audioControl {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  margin-left: 10px;
}

#audioControl img {
  width: 50px;
  height: 50px;
  border: 0;
}

#menu {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  z-index: 100;
}

#menuArrow {
  cursor: pointer;
  font-size: 2em;
  margin-bottom: 10px;
  transition: transform 0.3s ease-in-out, color 0.3s ease-in-out;
  transform: rotate(180deg);
  color: #555555;
}

#menuArrow:hover {
  transform: scale(1.5);
}

.menu-items {
  display: flex;
  flex-direction: column;
  position: fixed;
  top: 0;
  right: -80%; /* Start offscreen to the right */
  height: 100%;
  width: 500px; /* Increased width for desktop screens */
  background: rgba(30, 24, 24, 0.3); 
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-radius: 10px;
  box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
  overflow-y: auto;
  transition: right 0.5s ease-in-out;
  z-index: 101;
  color: #ffffff;
}

.menu-items.active {
  right: 0; /* Slides the menu into view */
}

/* Make the menu even more responsive for small screens */
@media (max-width: 600px) {
  .menu-items {
    width: 80vw; /* Use viewport width for small screens */
    right: -80vw; /* Adjust starting position */
  }
}

/* When active on small screens, it should still slide fully into view */
@media (max-width: 600px) {
  .menu-items.active {
    right: 0;
  }
}


/* Hover effect for menu items */
.menu-items:hover {
  box-shadow: 0 10px 40px rgba(31, 38, 135, 0.5); /* Slightly enhance shadow */
  background: rgba(30, 24, 24, 0.4); /* Slightly darker on hover */
}

/* Styling for individual menu items */
.menu-items .menu-item {
  padding: 15px;
  margin: 5px 10px;
  background: rgba(255, 255, 255, 0.1); /* Semi-transparent for item contrast */
  border-radius: 8px;
  text-align: center;
  transition: background 0.3s ease, transform 0.2s ease;
  color: #fff;
  cursor: pointer;
}

.menu-items .menu-item:hover {
  background: rgba(255, 255, 255, 0.2); /* Slightly brighter background on hover */
  transform: translateY(-3px); /* Lift effect on hover */
}

/* Scrollbar styling for the menu */
.menu-items::-webkit-scrollbar {
  width: 8px;
}

.menu-items::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2); /* Subtle scrollbar color */
  border-radius: 10px;
}

.menu-items::-webkit-scrollbar-track {
  background: transparent; /* Transparent track */
}


.menu-top {
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.menu-bottom {
  margin-top: auto;
  padding: 20px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.menu-item,
.menu-bottom a {
  color: #fff;
  padding: 15px;
  cursor: pointer;
  transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out, box-shadow 0.3s ease-in-out, transform 0.3s ease-in-out;
  border-radius: 5px;
  text-align: center;
  margin-bottom: 10px;
  background-color: #555;
  position: relative;
  z-index: 1;
}

.menu-bottom a img {
  width: 30px;
  height: 30px;
  border: 0;
  display: block;
}

.menu-item:active,
.menu-bottom a:active {
  box-shadow: 0 0 5px rgba(97, 218, 251, 0.8);
  transform: scale(0.95);
}

.menu-item:focus,
.menu-bottom a:focus {
  outline: none;
}

input[type="range"] {
  width: 80%;
  margin: 10px 0;
}







#audioPlayer {
  margin-top: 30px;
  cursor: pointer;
  position: relative;
  transition: transform 0.5s ease-in-out;
}

#audioPlayer:hover {
  transform: scale(1.2);
}

#audioPlayer img {
  width: 40px;
  height: 40px;
  border: 0;
}
.fade-in {
  animation: fadeIn 0.5s ease-in-out;
}

#verse-number {
  font-size: 1em;
  margin-top: 10px;
  text-align: center;
  direction: ltr;
}

#verse-number [dir="rtl"] {
  direction: rtl;
  text-align: right;
}

/* Search Container */
#searchContainer {
  position: relative;
  display: inline-block;
  margin-bottom: 15px;
}

#searchContainer input {
  width: 300px;
  padding-left: 40px; /* Space for the search icon */
  border-radius: 25px;
  box-shadow: inset 0 0 10px rgba(31, 38, 135, 0.3); /* Inner shadow for depth */
  padding: 10px 20px;
  background: rgba(30, 24, 24, 0.3); /* Glass-like background */
  backdrop-filter: blur(6px); /* Frosted glass blur */
  -webkit-backdrop-filter: blur(6px); /* Safari support */
  border: 1px solid rgba(255, 255, 255, 0.18); /* Subtle border */
  color: #fff; /* Input text color */
  font-size: 16px; /* Make text legible */
  transition: box-shadow 0.3s ease, background 0.3s ease; /* Smooth hover/focus effects */
}

#searchContainer input:focus {
  outline: none; /* Remove default focus outline */
  box-shadow: inset 0 0 15px rgba(31, 38, 135, 0.5); /* Enhanced inner shadow */
}

#searchContainer .fa-search {
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: rgba(255, 255, 255, 0.5); /* Subtle color for the icon */
  font-size: 16px; /* Icon size */
}

#searchInput::placeholder {
  color: rgba(255, 255, 255, 0.5); /* Subtle placeholder color */
  opacity: 1;
}

/* Search Button */
#searchButton {
  border-radius: 25px;
  padding: 10px 20px;
  margin-left: 10px; /* Reduced for better alignment */
  background: rgba(30, 24, 24, 0.3); /* Glass-like background */
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.18); /* Subtle border */
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37); /* Soft shadow for depth */
  cursor: pointer;
  transition: background 0.3s ease, box-shadow 0.3s ease; /* Smooth hover effects */
}

#searchButton:hover {
  background: rgba(30, 24, 24, 0.4); /* Slightly darker on hover */
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5); /* Enhanced shadow */
}

/* Search Results Container */
#searchResultsContainer {
  margin-top: 20px;
  padding: 20px;
  background: rgba(30, 24, 24, 0.3); /* Glass-like background */
  border-radius: 10px;
  color: #fff;
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37); /* Subtle shadow for depth */
  backdrop-filter: blur(6px); /* Frosted blur effect */
  -webkit-backdrop-filter: blur(6px); /* Safari support */
}

#searchResultsContainer h2 {
  margin-top: 0;
  color: #fff; /* Text color */
}

#searchResultsList {
  list-style: none;
  padding: 0;
  max-height: 300px;
  overflow-y: auto;
  margin: 0;
}

#searchResultsList li {
  padding: 12px; /* Increase padding for better readability */
  border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* Subtle divider */
  cursor: pointer;
  color: #fff;
  transition: background 0.3s ease, transform 0.2s ease; /* Add hover effects */
}

#searchResultsList li:hover {
  background: rgba(255, 255, 255, 0.2); /* Highlight background */
  transform: translateX(5px); /* Subtle movement on hover */
}

#searchResultsContainer button {
  padding: 10px 20px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: rgba(30, 24, 24, 0.3); /* Glass-like background */
  color: #ffffff;
  cursor: pointer;
  margin-bottom: 10px;
  transition: background 0.3s ease, transform 0.2s ease; /* Smooth hover effect */
}

#searchResultsContainer button:hover {
  background: rgba(30, 24, 24, 0.4); /* Slightly darker on hover */
  transform: translateY(-2px); /* Subtle lift on hover */
}


/* Modal Styling */
.modal {
  display: none;
  position: fixed;
  z-index: 1001;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.6);
}

.modal-content {
  background-color: #1f1e1e;
  margin: 10% auto;
  padding: 20px;
  border-radius: 6px;
  width: 80%;
  max-width: 500px;
  color: #fff;
}

.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  cursor: pointer;
}

.close:hover {
  color: #fff;
}

#tafsir-panel {
  display: none; /* Hide by default */
  position: fixed; /* Keep it independent of parent containers */
  bottom: 0;
  left: 0;
  width: 100%; /* Full width */
  max-height: 70%; /* Limit height */
  background-color: rgba(0, 0, 0, 0.95); /* Dark background for focus */
  color: #fff; /* Text color */
  overflow-y: auto; /* Allow scrolling for long tafsir */
  z-index: 1000; /* Ensure it appears on top of other elements */
  border-top: 2px solid #646060; /* Visual separation at the top */
  border-radius: 12px 12px 0 0; /* Rounded top corners */
  transform: translateY(100%); /* Start off-screen */
  transition: transform 0.3s ease-in-out; /* Smooth slide-in effect */
}

#tafsir-panel.active {
  display: block;
  transform: translateY(0); /* Bring it into view */
}


#tafsir-content {
  padding: 20px;
  text-align: center;
}

#tafsir-content h3 {
  margin-top: 0;
  text-align: center;
}

#tafsir-content button {
  margin-top: 20px;
  padding: 10px 20px;
  background-color: #4a4a4a;
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

#tafsir-content button:hover {
  background-color: #6a6a6a;
}


/* Active class to slide up the panel */
#tafsir-panel.active {
  bottom: 0;
}



/* Tafsir Panel Arabic Text Styling */
#tafsir-text-arabic {
  font-size: 2.2em;
  text-align: right;
  direction: rtl;
  margin-bottom: 10px;
}

#tafsir-text-english {
  font-size: 2em;
  text-align: left;
  direction: ltr;
  margin-bottom: 10px;
}

button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* Loop Button Style */
#loopControl {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  margin-left: 10px;
  background: none;
  border: none;
  padding: 0;
}

#loopControl img {
  width: 50px;
  height: 50px;
  border: none;
}

/* Speed Control Container */
#speedControl {
  display: flex;
  align-items: center;
  margin-top: 15px;
}

#speedSlider {
  -webkit-appearance: none;
  appearance: none;
  width: 200px;
  height: 8px;
  background: #000000;
  border-radius: 5px;
  outline: none;
  transition: background 0.3s ease;
  cursor: pointer;
}

#speedSlider::-webkit-slider-thumb,
#speedSlider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #000000;
  box-shadow: 0 0 2px rgba(0, 0, 0, 0.3);
  transition: background 0.3s ease, transform 0.2s ease;
}

#speedSlider:hover::-webkit-slider-thumb,
#speedSlider:hover::-moz-range-thumb {
  background: #ffffff;
  transform: scale(1.1);
}

#speedValue {
  margin-left: 10px;
  font-size: 1.2rem;
  color: #ffffff;
}

/* Progress Bar Container */
#progressControl {
  display: none; /* Hidden by default */
  align-items: center;
  margin-top: 15px;
  position: relative;
  width: 100%; /* Full width */
}

/* Progress Slider */
#progressSlider {
  -webkit-appearance: none; /* Remove default appearance */
  appearance: none;
  width: 100%;
  height: 10px; /* Adjust height for better visibility */
  background: linear-gradient(to right, #4caf50 0%, #4caf50 0%, #ccc 0%, #ccc 100%); /* Gradient background */
  border-radius: 5px;
  outline: none; /* Remove outline */
  cursor: pointer;
  transition: background 0.1s linear; /* Smooth background transition */
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
}

/* Progress Slider Thumb */
#progressSlider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px; /* Adjust size */
  height: 16px;
  background: #ffffff; /* Thumb color */
  border: 2px solid #4caf50; /* Border color */
  border-radius: 50%; /* Rounded thumb */
  cursor: pointer;
  box-shadow: 0 0 4px rgba(0, 0, 0, 0.3); /* Subtle shadow */
  transition: transform 0.2s ease; /* Add hover effect */
}

#progressSlider::-moz-range-thumb {
  width: 16px;
  height: 16px;
  background: #ffffff;
  border: 2px solid #4caf50;
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 0 4px rgba(0, 0, 0, 0.3);
  transition: transform 0.2s ease;
}

/* Add hover effect for the slider thumb */
#progressSlider:hover::-webkit-slider-thumb {
  transform: scale(1.2); /* Enlarge thumb slightly on hover */
}

#progressSlider:hover::-moz-range-thumb {
  transform: scale(1.2); /* Enlarge thumb slightly on hover */
}

/* Time Display */
#currentTime, #totalTime {
  font-size: 0.9rem;
  color: #fff; /* Text color */
  margin: 0 10px; /* Add spacing */
  text-align: center;
}

/* Tooltip Styling */
.tooltip {
  position: relative;
  display: inline-block;
  cursor: pointer;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 120px;
  background-color: #393333;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 5px;
  position: absolute;
  z-index: 1;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  opacity: 0;
  transition: opacity 0.3s;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}

/* Bottom-right buttons */
#bottom-right-buttons {
  display: flex;
  flex-direction: row;
  gap: 10px;
}

#bottom-right-buttons button {
  background: none;
  border: none;
  cursor: pointer;
}

/* Smartphones */
@media only screen and (max-width: 600px) {
  body {
    font-size: 14px;
  }
  #verse {
    font-size: 1.5em;
  }
  #translation {
    font-size: 1.2em;
  }
}

/* Tablets */
@media only screen and (min-width: 601px) and (max-width: 768px) {
  body {
    font-size: 16px;
  }
  #verse {
    font-size: 2em;
  }
  #translation {
    font-size: 1.5em;
  }
}

/* Desktops */
@media only screen and (min-width: 769px) {
  body {
    font-size: 18px;
  }
  #verse {
    font-size: 2.5em;
  }
  #translation {
    font-size: 1.8em;
  }
}

button:focus, a:focus {
  outline: 2px solid #61dafb;
}

body.high-contrast {
  background-color: #000;
  color: #fff;
}

body.high-contrast a {
  color: #0ff;
}

body.high-contrast button {
  background-color: #fff;
  color: #000;
}

#suggestionsList {
  list-style: none;
  padding: 0;
  margin: 0;
  position: absolute;
  background-color: #1f1e1e;
  width: 100%;
  max-height: 200px;
  overflow-y: auto;
  z-index: 1000;
}

#suggestionsList li {
  padding: 10px;
  border-bottom: 1px solid #333;
  cursor: pointer;
}

#suggestionsList li:hover {
  background-color: #333;
}

#dataLoadingOverlay p {
  font-size: 1.5em;
}

#logo {
  color: white;
  margin-bottom: 100px;
  position: fixed;
  top: 0;
  left: 0;
  mix-blend-mode: multiply;
}


/* Tooltip Container */
.tooltip {
  position: relative;
  display: inline-block;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 120px;
  background-color: #393333;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 5px;
  position: absolute;
  z-index: 1;
  bottom: 125%; /* Adjust as needed */
  left: 50%;
  transform: translateX(-50%);
  opacity: 0;
  transition: opacity 0.3s;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}
#toggleTranslationButton {
  width: none;
  background: none;
  border: none;
  cursor: pointer;
  font-size: 15px;
  color: #ffffff;
}


#sharingOptionsButton {
  background: none;
  border: none;
  font-size: 2em;
  cursor: pointer;
  margin-bottom: 10px;
}

#sharingOptionsButton img {
  margin-top: 35px;
  width: 40px;
  height: 40px;
}

#sharingOptionsButton:hover img {
  transform: scale(1.1);
  transition: transform 0.2s;
}
#toggleTranslationButton img {
  transform: scale(1.1);
  transition: transform 0.2s;
}


@keyframes fadeOutIn {
  0% { opacity: 1; transform: translateY(0); }
  50% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

#verse-container.fade {
  animation: fadeOutIn 1s ease-in-out;
}

/* Mood Selection Styling */
#moodSelect {
  width: 100%;
  padding: 8px;
  margin-top: 10px;
  font-size: 16px;
}
/* Styling for the select elements */
select {
  padding: 12px; /* Increased padding for better usability */
  margin: 10px 0; /* Maintain spacing between elements */
  border: 2px solid rgba(255, 255, 255, 0.18); /* Subtle border for glass effect */
  border-radius: 12px; /* Smoother, more modern rounded corners */
  font-size: 16px; /* Maintain legibility */
  background: rgba(30, 24, 24, 0.3); /* Glass-like semi-transparent background */
  color: #ffffff; /* High contrast for readability */
  width: 100%; /* Ensure full width for responsiveness */
  max-width: 400px; /* Limit width for larger screens */
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37); /* Soft shadow for depth */
  backdrop-filter: blur(6px); /* Frosted glass blur */
  -webkit-backdrop-filter: blur(6px); /* Safari support for blur */
  transition: box-shadow 0.3s ease, background 0.3s ease; /* Smooth hover/focus effects */
  outline: none; /* Remove default outline */
}

/* Hover effect for the select element */
select:hover {
  background: rgba(30, 24, 24, 0.4); /* Slightly darker background on hover */
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5); /* Enhance shadow */
}

/* Focus effect for accessibility */
select:focus {
  outline: 2px solid rgba(97, 218, 251, 0.8); /* Blue glow for focus */
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5); /* Same shadow as hover */
}


/* Button styling */
button {
  background: rgba(30, 24, 24, 0.3); /* Glass-like semi-transparent background */
  color: #ffffff; /* High contrast text for readability */
  padding: 12px 24px; /* Increased padding for better spacing */
  border: 1px solid rgba(255, 255, 255, 0.18); /* Subtle border for glass effect */
  border-radius: 12px; /* Smooth rounded corners */
  cursor: pointer;
  font-size: 16px;
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37); /* Soft shadow for depth */
  backdrop-filter: blur(6px); /* Frosted blur effect */
  -webkit-backdrop-filter: blur(6px); /* Safari support */
  transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease; /* Smooth effects */
}

/* Hover effect */
button:hover {
  background: rgba(30, 24, 24, 0.4); /* Slightly darker background on hover */
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5); /* Enhanced shadow */
  transform: translateY(-3px); /* Subtle lift effect */
}

/* Focus effect for accessibility */
button:focus {
  outline: 2px solid rgba(97, 218, 251, 0.8); /* Blue focus outline */
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5); /* Same shadow as hover */
}

/* Disabled button styling */
button:disabled {
  background: rgba(30, 24, 24, 0.2); /* Lighter background for disabled state */
  color: rgba(255, 255, 255, 0.5); /* Faded text color */
  cursor: not-allowed;
  box-shadow: none; /* Remove shadow for disabled state */
}


  /* Additional file input styling */
  input[type="file"] {
    margin-top: 15px;
  }

  /* Center the content for better aesthetics */
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: 'Arial', sans-serif;
  }

  /* Adding some margin to space out the elements */
  label {
    font-size: 18px;
    margin-bottom: 5px;
  }

  /* Styling for the entire container */
  .container {
    width: 100%;
    max-width: 600px;
    text-align: center;
    padding: 20px;
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

#donationButton {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 9999;
}

#donationButton img {
  width: 50px;
  height: 50px;
  cursor: pointer;
}

#donationButton img:hover {
  transform: scale(1.1);
  transition: transform 0.2s;
}
.title{
  font-size: 25px;
}#voiceSearchButton {
  background-color: transparent;
  border: none;
  cursor: pointer;
  font-size: 24px; /* Adjust size as needed */
  margin-left: 10px;
}

#voiceSearchButton:hover {
  color: #61dafb; /* Add hover effect */
}

.current-word {
  background-color: yellow;
}
/* Base styles (Mobile First Approach) */

body {
  font-size: 16px;
}

/* Smartphones (Portrait and Landscape) */
@media only screen and (max-width: 600px) {
  #verse {
    font-size: 1.5em;
  }
  #translation {
    font-size: 1.2em;
  }
  .button {
    font-size: 14px;
    padding: 10px 15px;
  }
  /* Adjust margins and paddings */
}

/* Tablets */
@media only screen and (min-width: 601px) and (max-width: 768px) {
  #verse {
    font-size: 2em;
  }
  #translation {
    font-size: 1.5em;
  }
  .button {
    font-size: 16px;
    padding: 12px 18px;
  }
}

/* Desktops */
@media only screen and (min-width: 769px) {
  #verse {
    font-size: 2.5em;
  }
  #translation {
    font-size: 1.8em;
  }
  .button {
    font-size: 18px;
    padding: 14px 20px;
  }
}
#verse-container {
  width: 90%; /* Adjust width to be responsive */
  max-width: 800px; /* Set a maximum width for larger screens */
  margin: 20px auto; /* Center the container */
}




:root {
  --primary-color: #61dafb;
  --secondary-color: #4a4a4a;
  --background-color: #1f1e1e;
  --text-color: #ffffff;
  --font-arabic: 'Amiri', serif;
  --font-english: 'Roboto', sans-serif;
}

body {
  background-color: var(--background-color);
  color: var(--text-color);
  font-family: var(--font-english);
}

#verse {
  font-family: var(--font-arabic);
  color: var(--text-color);
}



.button:hover,
button:hover,
.menu-item:hover {
  background-color: var(--primary-color);
  color: var(--background-color);
}
#audioControls {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  margin-top: 10px;
}

#audioControls button {
  background-color: var(--secondary-color);
  color: var(--text-color);
  border: none;
  padding: 10px;
  border-radius: 50%;
  font-size: 1.5em;
  cursor: pointer;
}

#audioControls button:hover {
  background-color: var(--primary-color);
}

#audioControls div {
  cursor: pointer;
}

#audioControls img {
  width: 40px;
  height: 40px;
  transition: transform 0.2s;
}

#audioControls img:hover {
  transform: scale(1.1);
}
/* Glass-like effect for the container */
.container {
  background: rgba(255, 255, 255, 0.2); /* Semi-transparent background */
  backdrop-filter: blur(10px); /* Blurs the background behind the container */
  -webkit-backdrop-filter: blur(10px); /* For Safari support */
  border: 1px solid rgba(255, 255, 255, 0.3); /* Subtle border */
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.37); /* Soft shadow for depth */
  border-radius: 12px; /* Rounded corners */
  padding: 20px; /* Space inside the container */
  color: #ffffff; /* Text color for contrast */
  max-width: 800px; /* Optional: limit the container's width */
  margin: 20px auto; /* Center the container */
  text-align: center; /* Optional: align content */
}

/* Add hover effects for interactivity */
.container:hover {
  background: rgba(255, 255, 255, 0.3); /* Slightly increase opacity */
  box-shadow: 0 8px 40px rgba(0, 0, 0, 0.5); /* More pronounced shadow */
}
/* Style the dropdown options */
select option {
  font-size: 14px; /* Adjust text size */
  background: rgba(30, 24, 24, 0.8); /* Glass-like background */
  color: #ffffff; /* Text color */
  text-align: center; /* Center-align text */
  padding: 8px; /* Add spacing for better readability */
  border-radius: 6px; /* Optional: modern rounding */
}
/* Checkbox Container */
.styled-checkbox-container {
  display: flex;
  align-items: center;
  gap: 8px; /* Space between checkbox and label */
  font-size: 16px;
  color: #ffffff;
  font-family: Arial, sans-serif;
  cursor: pointer;
  user-select: none;
  margin-top: 15px;
}

/* Reset Default Checkbox Styles */
.styled-checkbox {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: rgba(30, 24, 24, 0.3); /* Glass-like background */
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 4px;
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37); /* Subtle shadow for depth */
  position: relative;
  transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
  cursor: pointer;
}

/* Hover Feedback */
.styled-checkbox-container input[type="checkbox"]:hover + .styled-checkbox {
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5);
}

/* Checkmark */
.styled-checkbox::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 6px; /* Adjust the size of the checkmark */
  height: 12px; /* Adjust the height for proper proportions */
  border: solid #ffffff;
  border-width: 0 2px 2px 0; /* Create the checkmark */
  transform: translate(-50%, -50%) rotate(45deg); /* Correct orientation */
  opacity: 0; /* Initially hidden */
  transition: opacity 0.2s ease, transform 0.2s ease;
}

/* Input Checkbox */
.styled-checkbox-container input[type="checkbox"] {
  position: absolute;
  opacity: 0;
  visibility: hidden; /* Ensure it is not clickable outside of styled area */
  cursor: pointer;
}

.styled-checkbox-container input[type="checkbox"]:checked + .styled-checkbox {
  background: rgba(97, 218, 251, 0.5); /* Blue background on checked */
  transform: scale(1.1);
}

.styled-checkbox-container input[type="checkbox"]:checked + .styled-checkbox::after {
  opacity: 1; /* Show the checkmark */
  transform: translate(-50%, -50%) rotate(45deg); /* Ensure correct orientation */
}


/* High Contrast Button */
.high-contrast-button {
  border-radius: 25px;
  padding: 10px 20px;
  background: rgba(30, 24, 24, 0.3);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.18);
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37);
  cursor: pointer;
  transition: background 0.3s ease, box-shadow 0.3s ease;
}

.high-contrast-button:hover {
  background: rgba(30, 24, 24, 0.4);
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5);
}

/* Focus Styles for Accessibility */
.styled-checkbox:focus {
  outline: 2px solid #ffffff;
  outline-offset: 2px;
}

.high-contrast-button:focus {
  outline: 2px solid #ffffff;
  outline-offset: 2px;
}
  #arabic-link {
      color: blue;
      text-decoration: none;
      font-weight: bold;
  }

/* Share Button Container */
.share-button-container {
  position: relative;
  display: inline-block;
  text-align: center;
}

/* Main Share Button */
#mainShareButton {
  border-radius: 25px;
  padding: 10px 20px;
  background: rgba(30, 24, 24, 0.3);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.18);
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37);
  cursor: pointer;
  transition: background 0.3s ease, box-shadow 0.3s ease;
}

#mainShareButton:hover {
  background: rgba(30, 24, 24, 0.4);
  box-shadow: 0 6px 20px rgba(31, 38, 135, 0.5);
}

/* Share Options */
.share-options {
  display: none; /* Initially hidden */
  position: absolute;
  top: 100%; /* Position below the main button */
  left: 50%;
  transform: translateX(-50%);
  background: rgba(30, 24, 24, 0.3);
  border-radius: 10px;
  padding: 10px;
  box-shadow: 0 4px 16px rgba(31, 38, 135, 0.37);
  animation: fadeIn 0.3s ease-out;
  z-index: 10;
  flex-direction: column;
  gap: 10px;
}

/* Share Option Buttons */
.share-options .high-contrast-button.small {
  padding: 8px 15px;
  font-size: 14px;
  width: 100%; /* Full width of the container */
}

/* Animation */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateX(-50%) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
}




    .html2canvas-snapshot * {
      background-image: none !important;
      background-color: rgba(0, 0, 0, 0) !important;
      box-shadow: none !important;
      filter: none !important;
  }





  #bookmarkButtonpopup {
    background-color: #4cafa0 !important; /* Force the background to white */
    color: black !important; /* Force the text color to black */
    border: 2px solid #ccc; /* Add a light gray border */
    border-radius: 8px; /* Rounded corners for a modern look */
    padding: 10px; /* Add padding for better appearance */
    cursor: pointer; /* Change cursor to pointer */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
    transition: transform 0.2s ease, background-color 0.2s ease; /* Smooth effects */
  }
  
  /* Hover Effect */
  #bookmarkButtonpopup:hover {
    background-color: #f0f0f0 !important; /* Slightly darker on hover */
    transform: scale(1.05); /* Subtle zoom effect */
  }
  
  /* Active (Pressed) State */
  #bookmarkButtonpopup:active {
    background-color: #e0e0e0 !important; /* Even darker on click */
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2); /* Slightly reduced shadow */
  }
  
  /* Focused State */
  #bookmarkButtonpopup:focus {
    outline: 2px solid #61dafb; /* Highlight the button when focused */
  }
  













</style>
</head>

    <!-- Hidden Canvas Element -->
    <canvas id="verseCanvas" width="800" height="600" style="display: none;"></canvas>

    <!-- Donation Button -->
    <div id="donationButton">
      <a href="https://www.unrwa.org/donate" target="_blank" title="Donate to Palestine">
        <img src="https://cdn-icons-png.flaticon.com/512/5681/5681051.png" alt="Donate to Palestine" width="40" height="40">
      </a>
    </div>



    <div id="shareButtonContainer" class="share-button-container">
      <!-- Main Share Button -->
      <button id="mainShareButton" class="high-contrast-button">Share Verse</button>
    
      <!-- Hidden Share Options -->
      <div id="shareOptions" class="share-options">
        <button class="high-contrast-button small" onclick="shareOnFacebook()">Facebook</button>
        <button class="high-contrast-button small" onclick="shareOnTwitter()">Twitter</button>
        <button class="high-contrast-button small" onclick="shareOnWhatsApp()">WhatsApp</button>
        <button class="high-contrast-button small" onclick="downloadImage()">Download</button>
      </div>
    </div>
    
    
    




    <!-- Include html2canvas library -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <!-- Bookmark Modal -->
    <div id="bookmarkModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeBookmarkModal()">&times;</span>
        <h2>Add Bookmark</h2>
        <label for="categorySelect">Category:</label>
        <select id="categorySelect">
          <option value="favorites">Favorites</option>
          <option value="inspiration">Inspiration</option>
        </select>
        <br>
        <label for="newCategoryInput">New Category:</label>
        <input type="text" id="newCategoryInput" placeholder="Type a new category..." />
        <button onclick="addNewCategory()">Add Category</button>
        <br>
        <label for="noteInput">Note:</label>
        <textarea id="noteInput" rows="4" placeholder="Add your note here..."></textarea>
        <button onclick="saveBookmark()">Save Bookmark</button>        
      </div>
    </div>

    <!-- Bookmarked Verses Section -->
    <div id="bookmarkedVersesSection" style="display:none;">
      <h2>Bookmarked Verses</h2>
      <div id="bookmarkedVersesList"></div>
    </div>

    <div id="logo">
      <img src="https://media4.giphy.com/media/DsSXPxGsGbDueNJqvI/200w.gif?cid=6c09b952eopnmdlr6p0mreb6kg1ha97ldy9xxwmvk3uuzv0v&ep=v1_videos_related&rid=200w.gif&ct=v" height="250px">
    </div>

    <div id="toast" style="
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #333;
    color: white;
    padding: 15px;
    border-radius: 5px;
    display: none;
    z-index: 1000;
">Notification</div>

      <div id="loadingSpinner" style="display: none;">Loading...</div>
    <h1 class="title">Random Quranic Verse</h1>

    <!-- Bottom-right corner buttons, now side by side -->
    <div id="bottom-right-buttons" style="position: fixed; bottom: 20px; right: 20px; display: flex; gap: 10px;">
      <div class="tooltip">
          <button id="bookmarkButtonpopup" onclick="showBookmarksPopup()">
              <img src="https://cdn-icons-png.flaticon.com/512/15358/15358702.png" alt="Bookmark Icon" width="40" height="40">
          </button>
          <span class="tooltiptext">Bookmark</span>
      </div>
    </div>

    <!-- Bookmark Popup -->
    <div id="bookmarksPopup" class="popup">
      <h2>Your Bookmarked Verses</h2>
      <div>
        <input type="text" id="bookmarkSearchInput" placeholder="Search..." oninput="filterBookmarks()" />
        <select id="bookmarkCategoryFilter" onchange="filterBookmarks()">
          <option value="">All Categories</option>
        </select>
      </div>
      <div id="bookmarkedVersesContainer"></div>
      <button onclick="hideBookmarksPopup()">Exit</button>
      <button id="clearBookmarksButton" onclick="confirmClearBookmarks()">Clear Bookmarks</button>
    </div>
    



    <div id="menu">
      <div id="menuArrow" onclick="toggleMenu()">&#128295;</div>

      <div class="menu-items" id="menuItems">
        <!-- Menu Top Section -->
        <div class="menu-top">
          <!-- Search Container -->
          <div id="searchContainer">
            <label for="searchInput">Search:</label>
            <input type="text" id="searchInput" placeholder="Search in Arabic or English, or Surah:Ayah">
            <ul id="suggestionsList" style="display: none;"></ul>
            <small>Please enter a keyword (e.g., "mercy") or Surah and Ayah number (e.g., "2:255"). Exact verse searches in Arabic are not supported.</small>
            <button id="searchButton" onclick="performSearch()">Search</button>
          </div>
          <!-- Voice Search Button -->
          <div id="voiceSearchContainer" style="display: inline-block; position: relative;">
            <button id="voiceSearchButton" title="Voice Search">
              🎤
            </button>
          </div>
          <!-- Search Results Container -->
          <div id="searchResultsContainer" style="display: none;">
            <h2>Search Results</h2>
            <button onclick="hideSearchResults()">Close</button>
            <ul id="searchResultsList"></ul>
          </div>
          <!-- Pagination Controls -->
          <div id="paginationControls" style="display: none;">
            <button onclick="previousPage()">Previous</button>
            <span id="currentPage">1</span>
            <button onclick="nextPage()">Next</button>
          </div>
          <!-- Surah Selection Dropdown -->
          <label for="surahSelect">Select Surah:</label>
          <select id="surahSelect">
            <option value="all">All Surahs</option>
            <!-- Dynamically populate Surah options -->
          </select>
<!-- Existing translation dropdown -->
<label for="editionSelect">Select Translation 📖:</label>
<select id="editionSelect" onchange="changeEdition(this.value)"></select>

<!-- New secondary translation dropdown -->
<label for="secondEditionSelect">Compare with Another Translation:</label>
<select id="secondEditionSelect" onchange="changeSecondEdition(this.value)">
  <option value="">None</option>
</select>
  <!-- Reciter Dropdown -->
 <label for="reciterDropdown">Select Reciter 🎤:</label>
 <select id="reciterDropdown" onchange="changeReciter(this.value)">
 </select>
          
          
          <!-- Verse Size Slider -->
          <label>Change verse size 👀</label>
          <input type="range" min="0.8" max="5.0" step="0.1" value="3.0" id="sizeSlider" oninput="changeVerseSize(this.value)">
        </div>

        <!-- Menu Middle Section -->
        <div class="menu-middle">
          <!-- Sequential Playback Option -->
          <label class="styled-checkbox-container">
            <input type="checkbox" id="sequentialPlaybackCheckbox" onchange="toggleSequentialPlayback()">
            Continue Verses Sequentially
            <span class="styled-checkbox"></span>
          </label>
          
          <!-- High Contrast Button -->
          <button onclick="toggleHighContrast()" aria-label="Toggle High Contrast">High Contrast</button>
          <!-- Speed Control -->
          <div id="speedControl">
            <label for="speedSlider">Speed: </label>
            <input type="range" id="speedSlider" min="0.5" max="1.0" step="0.05" value="1.0" oninput="changePlaybackSpeed(this.value)">
            <span id="speedValue">1.0x</span>
          </div>
          <!-- Verse of the Day Size Slider -->
          <!-- Mood Selection -->
          <label for="moodSelect">Select Your Mood:</label>
          <select id="moodSelect" onchange="fetchVerseByMood(this.value)">
            <option value="">--Select Mood--</option>
            <option value="stressed">Stressed</option>
            <option value="happy">Happy</option>
            <!-- Add more moods -->
          </select>
          <!-- Wallpaper Mode Selection -->
          <label for="modeSelect">Select Wallpaper Mode:</label>
          <select id="modeSelect" onchange="changeWallpaperMode(this.value)">
            <option value="still">Still</option>
            <option value="rotation">Rotation</option>
          </select>
          <!-- Predefined Wallpapers -->
          <label for="predefinedWallpapers">Choose from Predefined Wallpapers:</label>
          <select id="predefinedWallpapers" onchange="setPredefinedWallpaper(this.value)">
            <option value="">--Select Predefined Wallpaper--</option>
            <option value="https://images.pexels.com/photos/36704/pexels-photo.jpg">Wallpaper 1</option>
            <option value="https://wallpapers.com/images/featured/islamic-xptqk5xw6adpezzv.jpg">Wallpaper 2</option>
            <option value="https://images.pexels.com/photos/1537086/pexels-photo-1537086.jpeg">Wallpaper 3</option>
            <option value="https://images.pexels.com/photos/26436656/pexels-photo-26436656.jpeg?cs=srgb&dl=pexels-ramiardilshad-26436656.jpg&fm=jpg">Wallpaper 4</option>
            <option value="https://www.hdwallpapers.in/download/mountain_pathway_between_grass_field_and_flowers_in_background_of_blue_sky_and_clouds_4k_hd_nature-3840x2160.jpg">Wallpaper 5</option>

            <!-- Add more predefined wallpapers here -->
          </select>
          <!-- File input for users to select wallpaper from their device -->
          <input type="file" id="fileInput" accept="image/*" onchange="handleFileUpload(event)">
          <!-- About Container -->
          <div class="about-container" id="aboutContainer" onclick="event.stopPropagation()">
            <h2>About This Website</h2>
            <p>This website provides a random Quranic verse along with audio recitation and translation. Explore the beauty of the Quran through random verses.</p>
            <p>For bug reporting or feedback, please click the button below:</p>
            <button id="reportBugButton" onclick="reportBug()">Report Bug</button>
          </div>
        </div>

        <!-- Menu Bottom Section -->
        <div class="menu-bottom">

          <button id="downloadAudioButton">Download Audio ⬇️</button>
          <!-- About Icon -->
          <div class="menu-item" onclick="showAbout(event)">
            <img src="https://cdn-icons-png.flaticon.com/512/1/1176.png" alt="About Icon" width="24" height="24">
          </div>
          <!-- GitHub Icon -->
          <a class="menu-item" href="https://github.com/yazan92" target="_blank">
            <img src="https://cdn-icons-png.flaticon.com/512/25/25231.png" alt="GitHub Icon">
          </a>
          <!-- Instagram Icon -->
          <a class="menu-item" href="https://www.instagram.com/1__7yzn/" target="_blank">
            <img src="https://cdn-icons-png.flaticon.com/512/725/725339.png" alt="Instagram Icon">
          </a>
        </div>
      </div>
    </div>

    <!-- Verse Container -->
    <div id="verse-container" data-verse-reference="">
      <div id="verse-content"> </div>

<!-- Audio Controls Container -->
<div id="audioControls" style="display: flex; align-items: center; justify-content: center; gap: 10px;">
  <!-- Loop Button -->
  <div id="loopControl" onclick="toggleLoop()">
    <img id="loopIcon" src="https://cdn-icons-png.flaticon.com/512/4700/4700580.png" alt="Loop Off" width="40" height="40">
  </div>

  <!-- Rewind Button (Initially Hidden) -->
  <div id="rewindButton" style="display: none;" onclick="rewindAudio()">
    <img src="https://cdn.iconscout.com/icon/premium/png-256-thumb/backward-s-7395155-6066411.png?f=webp&w=256" alt="Rewind" width="40" height="40">
  </div>

  <!-- Audio Control (Play/Pause) -->
  <div id="audioControl" onclick="toggleAudio()">
    <img id="audioIcon" src="https://cdn-icons-png.freepik.com/256/6707/6707113.png" alt="Audio Control" width="40" height="40">
  </div>

  <!-- Forward Button (Initially Hidden) -->
  <div id="forwardButton" style="display: none;" onclick="forwardAudio()">
    <img src="https://cdn.iconscout.com/icon/premium/png-256-thumb/forward-s-7395166-6066422.png?f=webp&w=256" alt="Forward" width="40" height="40">
  </div>
</div>


        <!-- Verse Display -->
        <p id="verse"></p>
        <button id="toggleTranslationButton" onclick="toggleTranslation()" title="Toggle Translation">
          <span id="translationArrow">&#x25BC;</span>
        </button>
        <div id="translations-container">
          <p id="translation"></p>
          <p id="second-translation" style="display:none;"></p>
        </div>
            
        <p id="verse-number"></p>

        <!-- Verse Buttons -->
        <div id="verse-buttons" style="display: flex; gap: 10px; justify-content: center;">
        
          <div class="tooltip">
            <a id="toggleAutoChangeButton" onclick="toggleVerseChange()">
              <img id="autoChangeIcon" src="https://cdn-icons-png.freepik.com/512/5192/5192715.png" alt="Stop Auto Change" width="40" height="40">
            </a>
            <span class="tooltiptext" id="autoChangeTooltip">Stop Auto Change</span>
          </div>
          

          <div class="tooltip">
            <a id="tafsirButton" onclick="toggleTafsir()">
              <img id="tafsirIcon" src="https://cdn-icons-png.flaticon.com/512/226/226011.png" alt="Open Book Icon" width="40" height="40">
            </a>
            <span class="tooltiptext" id="tafsirTooltip">Show Tafsir</span>
          </div>
          <div class="tooltip">
            <a id="newVerseButton" onclick="fetchVerse(getRandomVerseNumber())">
              <img src="https://cdn-icons-png.flaticon.com/512/16925/16925635.png" alt="New Verse Icon" width="40" height="40">
            </a>
            <span class="tooltiptext">New Verse</span>
          </div>
          <div class="tooltip">
            <a id="bookmarkButton" aria-label="Bookmark This Verse" onclick="bookmarkCurrentVerse()">
              <img src="https://cdn-icons-png.flaticon.com/512/9798/9798238.png" alt="Bookmark Icon" width="40" height="40">
            </a>
            <span class="tooltiptext">Bookmark This Verse</span>
          </div>
        </div>

        <progress id="progressBar" value="100" max="100" style="display: none;"></progress>
        <!-- Audio Progress Slider -->
        <div id="progressControl">
          <span id="currentTime">00:00</span>
          <input type="range" id="progressSlider" min="0" max="100" value="0" step="0.1" oninput="seekAudio(this.value)">
          <span id="totalTime">00:00</span>
        </div>

    <div id="dataLoadingOverlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center;">
      <p style="color: #fff; font-size: 1.5em;">Loading data...</p>
    </div>
  






  </div>
  <!-- Tafsir Panel -->
  <div id="tafsir-panel">
    <div id="tafsir-content">
      <h3 id="tafsir-title">التفسير</h3>
      <!-- Tafsir Selection Dropdown -->
      <label for="tafsirSelect">Choose Tafsir:</label>
      <select id="tafsirSelect" onchange="changeTafsir()">
        <option value="ar.muyassar">Tafsir Al-Muyassar</option>
        <option value="ar.jalalayn">Tafsir Al-Jalalayn</option>
        <option value="en.asad">The Message of the Quran (Muhammad Asad)</option>
        <!-- Add more tafsir options as needed -->
      </select>
      <p id="tafsir-text-arabic" dir="rtl"></p>
      <p id="tafsir-text-english"></p>
      <p id="tafsir-scholar"></p>
      <button onclick="toggleTafsir()">Close</button>
    </div>
  </div>
</div>
</div>






    <script>
        let isSequentialPlayback = false; // Tracks if sequential playback is enabled
        let currentVerseNumber = null; // Keeps track of the current verse number
        let isAudioEnabled = false; // Tracks if audio is enable
        let currentAudioPlayer = new Audio();
        let audioWasPlaying = false;
        let isMenuVisible = false;
        let verseChangeTimer;
        let isAudioPlaying = false;
        let audioPlayer = new Audio();
        let SECOND_TRANSLATION_EDITIONS = '';
        const VERSE_OF_THE_DAY_INTERVAL = 24 * 60 * 60 * 1000;

        window.onload = async () => {
          if (userWallpapers.length > 0) {
            startWallpaperRotation();
          }
          
          // Get the verse number from the URL parameters, or default to a random verse
          const urlParams = new URLSearchParams(window.location.search);
          let verseNumber = urlParams.get('verse');
          
          // If no verse number is provided, fetch a random verse
          if (!verseNumber) {
            verseNumber = getRandomVerseNumber(); 
          }
        
          // Load saved reciter and translation from localStorage if available
          const savedReciter = localStorage.getItem('selectedReciter');
          if (savedReciter) {
            EDITIONS = savedReciter;
            const reciterDropdown = document.getElementById('reciterDropdown');
            if (reciterDropdown) {
              reciterDropdown.value = savedReciter;
            }
          }
        
          const savedEdition = localStorage.getItem('selectedEdition');
          if (savedEdition) {
            TRANSLATION_EDITIONS = savedEdition;
            const editionSelect = document.getElementById('editionSelect');
            if (editionSelect) {
              editionSelect.value = savedEdition;
            }
          }
          closeMenuOnClickOutside(); // Add this to activate the functionality
          try {
            // Fetch and display the verse data with the user's preferred reciter and edition
            await fetchEnglishTranslationData();
            await populateSurahDropdown();
            await fetchVerse(verseNumber);
            
            // Start the auto-change timer after the verse has been fetched
            startVerseChangeTimer();
        
            await populateEditionDropdown();
        
          } catch (error) {
            console.error('Error fetching verse:', error);
          }
        };
        
        
        
        
      
        
        function showAbout(event) {
            event.stopPropagation(); // Prevent the event from reaching the document
            const aboutContainer = document.getElementById("aboutContainer");
            aboutContainer.style.display = (aboutContainer.style.display === "block") ? "none" : "block";
        }
        function reportBug() {
            // Redirect to your Instagram account
            window.location.href = "https://www.instagram.com/1__7yzn/";
        }        
        const API_BASE_URL = 'https://api.alquran.cloud/v1/ayah';
        const EDITION_IDENTIFIER = 'ar.alf'; // Default edition identifier
        let EDITIONS = 'ar.Alafasy';
        let TRANSLATION_EDITIONS = 'en.sahih'; // Default translation
        const VERSE_CHANGE_INTERVAL = 10000;



        async function fetchVerse(verseNumber) {
          try {
            if (!verseNumber || isNaN(verseNumber) || verseNumber <= 0 || verseNumber > 6236) {
              throw new Error('Invalid verseNumber provided to fetchVerse');
            }
        
            // Stop and reset audio if playing
            if (currentAudioPlayer && !currentAudioPlayer.paused) {
              currentAudioPlayer.pause();
              currentAudioPlayer.currentTime = 0;
              currentAudioPlayer.src = '';
              isAudioPlaying = false;
              document.getElementById('audioIcon').src = 'https://cdn-icons-png.flaticon.com/512/727/727245.png'; // Play icon
            }
        
            const verseData = await getVerseData(verseNumber);
            const translationData = await getTranslationData(verseNumber);
        
            // If SECOND_TRANSLATION_EDITIONS is set, fetch that translation too
            let secondTranslationData = null;
            if (SECOND_TRANSLATION_EDITIONS) {
              secondTranslationData = await getTranslationDataByEdition(verseNumber, SECOND_TRANSLATION_EDITIONS);
            }
        
            currentSurah = verseData.surah.number;
            currentAyah = verseData.numberInSurah;
        
            updateVerseUI(verseData, translationData);
            setVerseReference(`${verseData.surah.number}:${verseData.numberInSurah}`);
        
            // Update the second translation UI if applicable
            if (secondTranslationData) {
              updateSecondTranslationUI(secondTranslationData.text);
            } else {
              updateSecondTranslationUI('');
            }
        
            resetProgressSlider();
            currentVerseNumber = verseData.number;
            accumulatedText = '';
        
            return verseData.audio;
          } catch (error) {
            console.error('Error fetching verse:', error);
          }
        }
        
        async function getTranslationDataByEdition(verseNumber, edition) {
          const response = await axios.get(`${API_BASE_URL}/${verseNumber}/${edition}`);
          return response.data.data;
        }
        
        



// Function to reset the progress slider when fetching a new verse
function resetProgressSlider() {
  const progressSlider = document.getElementById('progressSlider');
  progressSlider.value = 0; // Reset the slider to the beginning
}



      

          
        async function getTranslationData(verseNumber) {
            const response = await axios.get(`${API_BASE_URL}/${verseNumber}/${TRANSLATION_EDITIONS}`);
            return response.data.data;
        }
// Ensure audio progresses to the next verse automatically
async function getAudioUrl() {
  const verseContainer = document.getElementById('verse-container');
  const verseReference = verseContainer.dataset.verseReference;
  if (verseReference) {
      const response = await axios.get(`https://api.alquran.cloud/v1/ayah/${verseReference}/editions/${EDITIONS}`);
      if (response.data.data && response.data.data.length > 0) {
          return response.data.data[0].audio;
      } else {
          throw new Error('Audio data not available for this verse.');
      }
  } else {
      throw new Error('Verse reference is undefined.');
  }
}

        
        
async function getVerseData(verseNumber) {
  if (!verseNumber) {
    throw new Error('Invalid verseNumber provided to getVerseData');
  }
  const response = await axios.get(`${API_BASE_URL}/${verseNumber}/${EDITIONS}`);
  return response.data.data;
}

function handleFileUpload(event) {
  const file = event.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function (e) {
      const uploadedWallpaper = e.target.result; // Data URL for the uploaded image

      // Set the uploaded image as the wallpaper
      document.body.style.backgroundImage = `url('${uploadedWallpaper}')`;
      document.body.style.backgroundSize = 'cover';
      document.body.style.backgroundPosition = 'center';

      // Stop wallpaper rotation if active
      if (wallpaperChangeInterval) {
        clearInterval(wallpaperChangeInterval);
      }

      // Add the uploaded image to the dropdown
      addUploadedWallpaperToDropdown(uploadedWallpaper);
    };
    reader.readAsDataURL(file);
  }
}


function updateVerseUI(verseData, translationData) {
  const verseElement = document.getElementById('verse');
  const translationElement = document.getElementById('translation');
  const verseNumberElement = document.getElementById('verse-number');
  const verseContainer = document.getElementById('verse-container');

  // Store the overall verse number (absolute verse number in the Quran)
  verseContainer.dataset.overallVerseNumber = verseData.number;

  // Also store the surah:ayah reference for other purposes
  verseContainer.dataset.verseReference = `${verseData.surah.number}:${verseData.numberInSurah}`;

  // Display the verse text
  verseElement.innerHTML = `<strong>${verseData.text}</strong>`;

  // Display the translation
  translationElement.innerHTML = translationData.text;

  // Extract additional details
  const surahNameArabic = verseData.surah.name;
  const surahNameEnglish = verseData.surah.englishName;
  const verseNumber = verseData.numberInSurah;
  const pageNumber = verseData.page;

  // Display surah name, verse number, and page number
  verseNumberElement.innerHTML = `
    Surah ${surahNameEnglish} (${surahNameArabic}) – Ayah ${verseNumber} (Page ${pageNumber})
  `;
}




        
        
        
        
        
          
        async function playAudioInternal(audioPlayer) {
            try {
                const audioUrl = await getAudioUrl();
        
                // Clear the existing timer if it exists
                if (verseChangeTimer) {
                    clearInterval(verseChangeTimer);
                }
        
                // Set the current audio player
                currentAudioPlayer = audioPlayer;
        
                // Add event listener for when the audio ends
                audioPlayer.addEventListener('ended', () => {
                    isAudioPlaying = false;
                    // Restart the verse change timer
                    startVerseChangeTimer();
                });
        
                // Set the audio source and play
                audioPlayer.src = audioUrl;
                await audioPlayer.play();
        
                isAudioPlaying = true;
            } catch (error) {
                handleErrors(error, 'Error playing audio:');
            }
        }
        
        function startVerseChangeTimer() {
          if (verseChangeTimer) {
            clearInterval(verseChangeTimer);
          }
        
          if (!isSequentialPlayback) {
            // Only set a timer for non-sequential playback
            verseChangeTimer = setInterval(async () => {
              if (!isAudioPlaying) {
                const randomVerseNumber = getRandomVerseNumber();
                await fetchVerse(randomVerseNumber);
              }
            }, VERSE_CHANGE_INTERVAL);
          } else {
            // Sequential playback: ensure the next verse is fetched when the audio ends
            if (currentAudioPlayer) {
              currentAudioPlayer.addEventListener('ended', async () => {
                if (isSequentialPlayback && currentVerseNumber !== null && currentVerseNumber !== undefined) {
                  currentVerseNumber += 1;
                  if (currentVerseNumber > 6236) {
                    currentVerseNumber = 1; // Loop back to the first verse
                  }
                  await fetchVerse(currentVerseNumber);
                  if (isAudioEnabled) {
                    playAudio(); // Automatically play the next verse
                  }
                }
              });
            }
          }
        }
        
        
        
          
        function toggleProgressBar(visible) {
          const progressControl = document.getElementById('progressControl');
          if (visible) {
            progressControl.style.display = 'flex'; // Show progress bar
          } else {
            progressControl.style.display = 'none'; // Hide progress bar
          }
        }
        
        // Update the audio `ended` event to consider sequential playback
        if (currentAudioPlayer) {
          currentAudioPlayer.addEventListener('ended', async () => {
            if (isSequentialPlayback && currentVerseNumber) {
              // If sequential playback is enabled, fetch and play the next verse
              currentVerseNumber += 1;
              if (currentVerseNumber > 6236) {
                currentVerseNumber = 1; // Loop back to the first verse
              }
              await fetchVerse(currentVerseNumber);
              playAudio(); // Automatically play the next verse
            } else {
              // Hide progress bar if sequential playback is not active
              toggleProgressBar(false);
            }
          });
        }
        
        // Update `toggleAudio` to handle progress bar visibility
        function toggleAudio() {
          const audioIcon = document.getElementById('audioIcon');
        
          if (currentAudioPlayer && !currentAudioPlayer.paused) {
            // Pause the audio
            currentAudioPlayer.pause();
            isAudioPlaying = false;
            audioIcon.src = 'https://cdn-icons-png.flaticon.com/512/727/727245.png'; // Play icon
            if (!isSequentialPlayback) {
              toggleProgressBar(false); // Hide progress bar only if auto-play is off
            }
          } else {
            // Play the audio
            playAudio();
            toggleProgressBar(true); // Show progress bar
          }
        }
        
        
        
        
        async function playAudio() {
          try {
            const audioUrl = await getAudioUrl();
        
            // Stop the current audio if it's playing
            if (currentAudioPlayer) {
              currentAudioPlayer.pause();
              currentAudioPlayer.currentTime = 0; // Reset the current audio
            }
        
            // Initialize a new audio player and play the audio
            currentAudioPlayer = new Audio(audioUrl);
            currentAudioPlayer.play();
            isAudioPlaying = true;
            isAudioEnabled = true; // Ensure this is set to true when audio plays
        
            // Update the icon to show the pause icon when audio is playing
            document.getElementById('audioIcon').src = 'https://cdn-icons-png.flaticon.com/512/727/727240.png'; // Pause icon
        
            // Show the forward and rewind buttons
            document.getElementById('rewindButton').style.display = 'block';
            document.getElementById('forwardButton').style.display = 'block';
        
            // Add event listener to handle next verse playback instantly
            currentAudioPlayer.addEventListener('ended', async () => {
              if (isSequentialPlayback && currentVerseNumber) {
                currentVerseNumber += 1;
                if (currentVerseNumber > 6236) {
                  currentVerseNumber = 1; // Loop back to the start
                }
                await fetchVerse(currentVerseNumber);
                playAudio(); // Automatically play the next verse
              }
            });
        
            // Add event listener to update the progress slider as the audio plays
            currentAudioPlayer.addEventListener('timeupdate', updateProgressSlider);
        
            // Reset audio playing state when the audio ends
            currentAudioPlayer.addEventListener('ended', () => {
              isAudioPlaying = false;
              document.getElementById('audioIcon').src = 'https://cdn-icons-png.flaticon.com/512/727/727245.png'; // Play icon
        
              // Hide the forward and rewind buttons when audio ends
              document.getElementById('rewindButton').style.display = 'none';
              document.getElementById('forwardButton').style.display = 'none';
            });
          } catch (error) {
            console.error('Error playing audio:', error);
            alert('Error playing the audio.');
          }
        }
        
      
    
      
      
      
        function getRandomVerseNumber(currentVerseNumber) {
            const totalVerses = 6236; // Total number of verses in the Quran
            let randomVerseNumber;
            do {
                randomVerseNumber = Math.floor(Math.random() * totalVerses) + 1; // Random number between 1 and 6236
            } while (randomVerseNumber === currentVerseNumber);
            return randomVerseNumber;
        }
        
        function setVerseReference(verseReference) {
            const verseContainer = document.getElementById('verse-container');
            verseContainer.dataset.verseReference = verseReference;
        }

        function toggleMenu() {
          const menu = document.getElementById("menuItems");
          menu.classList.toggle("active");
        }
        
        
        

function changeTheme() {
    const body = document.body;
    const menu = document.getElementById('menu');
    const updateScreen = document.getElementById('update-screen');
    
    // Toggle dark mode class on body
    body.classList.toggle('dark-theme');
    
    // Toggle dark mode class on menu
    menu.classList.toggle('dark-theme');
    
    // Toggle dark mode class on update screen
    updateScreen.classList.toggle('dark-theme');
    
    // Additional styling for specific elements (adjust as needed)
    if (body.classList.contains('dark-theme')) {
        // Dark mode
        body.style.backgroundColor = '#000';
        body.style.backgroundImage = 'none';
        // Set text color to white
        body.style.color = '#fff';
        // Additional styling for other elements
    } else {
        // Light mode (reverting to original background)
        body.style.backgroundColor = '';
        body.style.backgroundImage = originalBackgroundImage;
        // Set text color to original color (e.g., black)
        body.style.color = '#000'; // Replace with your original text color
        // Additional styling for other elements
    }
}

        function changeVerseSize(size) {
            const verseElement = document.getElementById('verse');
            verseElement.style.fontSize = `${size}em`;
        }

        
        function showMenu() {
            const menuItems = document.getElementById('menuItems');
            menuItems.style.width = '20%'; // Adjust the width based on your preference
            menuItems.style.right = '0';
            isMenuVisible = true;
            document.getElementById('menuArrow').classList.add('arrow-rotate');
        }
        let startX = 0;

// Detect touchstart to track the initial touch point
document.addEventListener('touchstart', handleTouchStart, false);
document.addEventListener('touchmove', handleTouchMove, false);

function handleTouchStart(event) {
  startX = event.touches[0].clientX;
}

function handleTouchMove(event) {
  if (!startX) return;

  const currentX = event.touches[0].clientX;
  const deltaX = currentX - startX; // Calculate swipe distance

  const menu = document.getElementById('menuItems');
  const swipeThreshold = 50; // Adjust for sensitivity

  if (deltaX > swipeThreshold) {
    // Swipe right - Close menu
    if (menu.classList.contains('active')) {
      menu.classList.remove('active');
    }
    startX = 0; // Reset startX to prevent continuous triggering
  } else if (deltaX < -swipeThreshold) {
    // Swipe left - Open menu
    if (!menu.classList.contains('active')) {
      menu.classList.add('active');
    }
    startX = 0; // Reset startX
  }
}

        function hideMenu() {
            const menuItems = document.getElementById('menuItems');
            menuItems.style.width = '0';
            menuItems.style.right = '-50%';
            isMenuVisible = false;
            document.getElementById('menuArrow').classList.remove('arrow-rotate');
        }
        // Prevent the menu from closing when interacting with its content
        document.getElementById('menuItems').addEventListener('click', function (event) {
            event.stopPropagation(); // Prevent the click event from propagating to document
        });
        
        // Close the menu if the user clicks outside the menu
        document.addEventListener('click', function (event) {
            const menu = document.getElementById('menu');
        
            if (isMenuVisible && !menu.contains(event.target)) {
                hideMenu();
            }
        });
        function showVolumeSlider() {
            const volumeSliderContainer = document.getElementById('volumeSliderContainer');
            volumeSliderContainer.style.display = 'block';
        }
        
function changeVolume(volume) {
    const audioPlayers = document.querySelectorAll('#verse-container audio');
    audioPlayers.forEach((audioPlayer) => {
        audioPlayer.volume = volume;
    });
}
   
               // Add this function to toggle the reciter list
        function toggleReciterList() {
            const reciterList = document.getElementById('reciterList');
            if (reciterList.style.display === 'none' || !reciterList.style.display) {
                reciterList.style.display = 'block';
            } else {
                reciterList.style.display = 'none';
            }
        }
        function changeReciter(reciterIdentifier) {
          EDITIONS = reciterIdentifier; // Update the global identifier for the new reciter
          localStorage.setItem('selectedReciter', reciterIdentifier); // Save the selected reciter for persistence
      
          const verseContainer = document.getElementById('verse-container');
          const verseReference = verseContainer.dataset.verseReference; // Get the current verse reference (e.g., "2:255")
      
          if (verseReference) {
              // Stop and restart the verse change timer
              resetVerseChangeTimer();
      
              // Update the audio source for the current verse
              updateAudioSource(verseReference);
          } else {
              console.error('No verse reference found to update reciter.');
              alert('Please select a verse first before changing the reciter.');
          }
      }
      
      
      
      
      
        
      


        let bookmarkedVerses = []; // Array to store bookmarked verses

        function bookmarkCurrentVerse() {
          // Open the modal
          document.getElementById('bookmarkModal').style.display = 'block';
        
          // Stop the verse change timer
          stopVerseChangeTimer();
        }
        
        function closeBookmarkModal() {
          document.getElementById('bookmarkModal').style.display = 'none';
        
          // Resume the verse change timer
          startVerseChangeTimer();
        }
        

function isVerseBookmarked(verseReference) {
    // Check if the verse is already bookmarked
    return bookmarkedVerses.some(verse => verse.verseReference === verseReference);
}

function saveBookmarksToLocalStorage() {
    // Save the bookmarks array to local storage
    localStorage.setItem('bookmarkedVerses', JSON.stringify(bookmarkedVerses));
}

function loadBookmarksFromLocalStorage() {
  const storedBookmarks = localStorage.getItem('bookmarkedVerses');
  if (storedBookmarks) {
      bookmarkedVerses = JSON.parse(storedBookmarks);
      updateBookmarkedVersesContainer(); // Update UI when loading
  }
}

function updateBookmarkedVersesContainer() {
  const container = document.getElementById('bookmarkedVersesContainer');
  container.innerHTML = '';

  // Collect categories to populate the filter
  const uniqueCategories = new Set();

  bookmarkedVerses.forEach(verse => {
    uniqueCategories.add(verse.category);

    const verseElement = document.createElement('div');
    verseElement.className = 'bookmarkedVerse';
    verseElement.innerHTML = `
      <strong>${verse.verseText}</strong><br>
      ${verse.translationText}<br>
      <em>Category: ${verse.category}</em><br>
      <p>Note: ${verse.note}</p>
      <small>Date Added: ${verse.dateAdded}</small>
    `;
    verseElement.addEventListener('click', () => {
      displayBookmarkedVerse(verse.verseReference);
    });
    container.appendChild(verseElement);
  });

  // Update category filter dropdown
  const categoryFilter = document.getElementById('bookmarkCategoryFilter');
  categoryFilter.innerHTML = '<option value="">All Categories</option>';
  uniqueCategories.forEach(cat => {
    const opt = document.createElement('option');
    opt.value = cat;
    opt.textContent = cat.charAt(0).toUpperCase() + cat.slice(1);
    categoryFilter.appendChild(opt);
  });
}



// Load bookmarks from local storage when the page loads
document.addEventListener("DOMContentLoaded", function () {
    // ... (your existing code)
    loadBookmarksFromLocalStorage();
    updateBookmarkedVersesContainer(); // Update bookmarks container when the page loads
});

function showBookmarksPopup() {
    updateBookmarkedVersesContainer();
    const popup = document.getElementById('bookmarksPopup');
    popup.style.display = 'block';
}

function hideBookmarksPopup() {
    const popup = document.getElementById('bookmarksPopup');
    popup.style.display = 'none';
}
// Function to clear bookmarks
function clearBookmarks() {
  // Clear the bookmarks array
  bookmarkedVerses = [];

  // Remove from local storage
  localStorage.removeItem('bookmarkedVerses');

  // Update the bookmarks UI
  updateBookmarkedVersesContainer();
}


// Add an event listener to the clear bookmarks button
document.getElementById('clearBookmarksButton').addEventListener('click', confirmClearBookmarks);
function displayNewVerse(verse, translation) {
    var verseContent = document.getElementById("verse-content");

    // Add fade-in animation class
    verseContent.classList.add("fade-in");

    // Update verse content
    document.getElementById("verse").innerText = verse;
    document.getElementById("translation").innerText = translation;

    // Remove fade-in animation class after animation completes
    setTimeout(function() {
        verseContent.classList.remove("fade-in");
    }, 500); // Adjust timing to match animation duration
}





function changeVerseOfDaySize(size) {
    const verseOfDayElement = document.getElementById('verse-of-the-day');
    verseOfDayElement.style.fontSize = `${size}em`;
}



function handleErrors(error, message) {
    console.error(`${message} ${error}`);
    alert(`${message} ${error}`);
}





function isSurahAyahFormat(query) {
    return /^\d+:\d+$/.test(query);
}

function isNumeric(value) {
    return /^-?\d+$/.test(value);
}

async function getVerseDataBySurahAyah(surahNumber, ayahNumber) {
  const response = await axios.get(`${API_BASE_URL}/${surahNumber}:${ayahNumber}/${EDITIONS}`);
  return response.data.data;
}


async function getTranslationDataBySurahAyah(surahNumber, ayahNumber) {
    const response = await axios.get(`${API_BASE_URL}/${surahNumber}:${ayahNumber}/${TRANSLATION_EDITIONS}`);
    return response.data.data;
}




let currentPage = 1;
let currentQuery = '';


async function nextPage() {
  if (currentPage < totalPages) {
    currentPage++;
    await fetchVerseByKeyword(currentQuery, /[\u0600-\u06FF]/.test(currentQuery), currentPage, document.getElementById('surahSelect').value);
  }
}

async function previousPage() {
  if (currentPage > 1) {
    currentPage--;
    await fetchVerseByKeyword(currentQuery, /[\u0600-\u06FF]/.test(currentQuery), currentPage, document.getElementById('surahSelect').value);
  }
}


async function displayVerseByNumber(verseNumber) {
  try {
      const verseData = await getVerseData(verseNumber);
      const translationData = await getTranslationData(verseNumber);

      updateVerseUI(verseData, translationData);
      setVerseReference(verseData.number);

      // Reset audio and timers
      if (currentAudioPlayer) {
          currentAudioPlayer.pause();
      }
      clearInterval(verseChangeTimer);

      // Scroll to the top of the page
      window.scrollTo({ top: 0, behavior: 'smooth' });
  } catch (error) {
      handleErrors(error, 'Error displaying verse:');
  }
}









function changeTafsir() {
  const selectedTafsir = document.getElementById('tafsirSelect').value;
  localStorage.setItem('selectedTafsir', selectedTafsir);

  // Fetch the Tafsir again with the new selection
  const verseContainer = document.getElementById('verse-container');
  const verseReference = verseContainer.dataset.verseReference;
  fetchTafsir(verseReference);
}



async function fetchTafsir(verseNumber) {
  try {
    const selectedTafsir = localStorage.getItem('selectedTafsir') || 'ar.muyassar';

    // Fetch the tafsir for the selected verse
    const response = await axios.get(`https://api.alquran.cloud/v1/ayah/${verseNumber}/${selectedTafsir}`);
    const tafsirData = response.data.data;
    const tafsirText = tafsirData.text;
    const tafsirScholar = tafsirData.edition.name;
    const tafsirLanguage = tafsirData.edition.language;

    // Update the Tafsir content
    if (tafsirLanguage === 'ar') {
      document.getElementById('tafsir-text-arabic').innerText = tafsirText;
      document.getElementById('tafsir-text-english').innerText = '';
    } else {
      document.getElementById('tafsir-text-arabic').innerText = '';
      document.getElementById('tafsir-text-english').innerText = tafsirText;
    }

    document.getElementById('tafsir-scholar').innerText = `- ${tafsirScholar}`;
  } catch (error) {
    console.error('Error fetching Tafsir:', error);
    document.getElementById('tafsir-text-arabic').innerText = 'Tafsir not available for this verse.';
    document.getElementById('tafsir-text-english').innerText = '';
    document.getElementById('tafsir-scholar').innerText = '';
  }
}





function toggleTafsir() {
  const tafsirPanel = document.getElementById('tafsir-panel');
  const tafsirIcon = document.getElementById('tafsirIcon');
  const tafsirTooltip = document.getElementById('tafsirTooltip');
  let audioWasPlaying = false;

  if (tafsirPanel.classList.contains('active')) {
    // Hide Tafsir
    tafsirPanel.classList.remove('active');
    tafsirIcon.src = 'https://cdn-icons-png.flaticon.com/512/226/226011.png'; // Open book icon
    tafsirTooltip.innerHTML = 'Show Tafsir';

    // Resume the verse change timer
    startVerseChangeTimer();

    // Resume audio if it was playing before
    if (audioWasPlaying) {
      toggleAudio(); // This will start the audio again
    }
  } else {
    // Show Tafsir
    tafsirPanel.classList.add('active');
    tafsirIcon.src = 'https://static.thenounproject.com/png/2258479-200.png'; // Closed book icon
    tafsirTooltip.innerHTML = 'Hide Tafsir';
    if (!tafsirPanel.classList.contains('active')) {
      // Set the select dropdown to the saved Tafsir
      const selectedTafsir = localStorage.getItem('selectedTafsir') || 'ar.muyassar';
      document.getElementById('tafsirSelect').value = selectedTafsir;
    }
    // Pause the verse change timer
    stopVerseChangeTimer();

    // Pause audio if it's playing
    if (isAudioPlaying) {
      audioWasPlaying = true;
      toggleAudio(); // This will pause the audio
    } else {
      audioWasPlaying = false;
    }

    // Fetch Tafsir for the current verse
    const verseContainer = document.getElementById('verse-container');
    const verseReference = verseContainer.dataset.verseReference;
    fetchTafsir(verseReference);
  }

  // Disable or enable the "New Verse" button
  const fetchVerseButton = document.getElementById('newVerseButton');
  fetchVerseButton.disabled = tafsirPanel.classList.contains('active');
}



const languageMap = {
  ar: 'Arabic',
  en: 'English',
  ur: 'Urdu',
  fr: 'French',
  ru: 'Russian',
  id: 'Indonesian',
  bn: 'Bengali',
  tr: 'Turkish',
  fa: 'Farsi',
  // Add more as needed
};

async function fetchReciters() {
  try {
      // Fetch all reciters data from the API
      const response = await axios.get('https://api.alquran.cloud/v1/edition?format=audio&type=versebyverse');
      const reciters = response.data.data;

      // Get the dropdown element
      const reciterDropdown = document.getElementById('reciterDropdown');
      reciterDropdown.innerHTML = ''; // Clear existing options

      // Populate the dropdown with all reciters
      reciters.forEach(reciter => {
          const option = document.createElement('option');
          option.value = reciter.identifier; // Use identifier for audio source

          // Get the full language name using the languageMap
          const languageName = languageMap[reciter.language] || reciter.language.toUpperCase();

          // Display reciter name in English and their full language name
          option.textContent = `${reciter.englishName || reciter.name} (${languageName})`;
          reciterDropdown.appendChild(option);
      });

      // Set default reciter if saved in localStorage
      const savedReciter = localStorage.getItem('selectedReciter');
      if (savedReciter) {
          reciterDropdown.value = savedReciter;
      }
  } catch (error) {
      console.error('Error fetching reciters:', error);
  }
}

// Call this function on page load to populate the dropdown
fetchReciters();

// Call this function on page load to populate the dropdown
fetchReciters();



  async function displayBookmarkedVerse(verseReference) {
    try {
      stopVerseChangeTimer();
  
      const verseData = await getVerseData(verseReference);
      const translationData = await getTranslationData(verseReference);
  
      updateVerseUI(verseData, translationData);
      setVerseReference(`${verseData.surah.number}:${verseData.numberInSurah}`);
  
      // Update currentVerseNumber
      currentVerseNumber = verseData.number;
  
      // If sequential playback is enabled, start the timer
      if (isSequentialPlayback) {
        startVerseChangeTimer();
      }
  
      // If audio is enabled, play the audio
      if (isAudioEnabled) {
        playAudio();
      }
    } catch (error) {
      handleErrors(error, 'Error fetching bookmarked verse:');
    }
  }
  
  
  
  function stopVerseChangeTimer() {
    if (verseChangeTimer) {
      clearInterval(verseChangeTimer);
      verseChangeTimer = null;
    }
  }
  
let isLooping = false;

function toggleLoop() {
  const loopIcon = document.getElementById('loopIcon'); // Get the loop icon element

  // Check if audio is playing before allowing loop to toggle
  if (!currentAudioPlayer || !isAudioPlaying) {
      alert("No audio is currently playing to loop.");
      return;
  }

  // Toggle the loop state
  isLooping = !isLooping;

  // Update the icon based on the loop state
  if (isLooping) {
      loopIcon.src = ' https://cdn-icons-png.flaticon.com/512/66/66758.png'; // Loop On icon
      loopIcon.alt = 'Loop On';

      // Stop the verse change timer while looping
      stopVerseChangeTimer();
  } else {
      loopIcon.src = 'https://cdn-icons-png.flaticon.com/512/4700/4700580.png'; // Loop Off icon
      loopIcon.alt = 'Loop Off';

      // Restart the verse change timer when looping is off
      startVerseChangeTimer();
  }

  // Manage the loop event listener
  currentAudioPlayer.removeEventListener('ended', playLoop); // Prevent duplication
  if (isLooping) {
      currentAudioPlayer.addEventListener('ended', playLoop);
  }
}


function playLoop() {
  // Reset the audio to the start of the verse and play it again
  currentAudioPlayer.currentTime = 0;
  currentAudioPlayer.play();

  // Do not set isAudioPlaying to false, because the loop is active
  isAudioPlaying = true; // Keep the audio state active while looping
  document.getElementById('audioIcon').src = 'https://cdn-icons-png.flaticon.com/512/727/727240.png'; // Pause icon
}

function changePlaybackSpeed(speed) {
  const speedValueDisplay = document.getElementById('speedValue');
  speedValueDisplay.innerText = `${speed}x`; // Update the displayed speed value

  if (currentAudioPlayer) {
      currentAudioPlayer.playbackRate = speed; // Set the playback speed of the audio
  }
}
function updateProgressSlider() {
  const progressSlider = document.getElementById('progressSlider');
  const currentTimeDisplay = document.getElementById('currentTime');
  const totalTimeDisplay = document.getElementById('totalTime');

  if (currentAudioPlayer && currentAudioPlayer.duration) {
    const currentTime = currentAudioPlayer.currentTime;
    const duration = currentAudioPlayer.duration;

    // Calculate the progress percentage
    const progressPercent = (currentTime / duration) * 100;

    // Update the slider's value and background gradient
    progressSlider.max = duration; // Ensure slider max matches duration
    progressSlider.value = currentTime; // Update slider value
    progressSlider.style.background = `linear-gradient(to right, #4caf50 ${progressPercent}%, #ccc ${progressPercent}%)`;

    // Smooth real-time updates using requestAnimationFrame
    requestAnimationFrame(() => {
      currentTimeDisplay.textContent = formatTime(currentTime);
      totalTimeDisplay.textContent = formatTime(duration);
    });
  }
}

// Helper function to format time in MM:SS
function formatTime(seconds) {
  const minutes = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
}


if (currentAudioPlayer) {
  // Update total duration when metadata is loaded
  currentAudioPlayer.addEventListener('loadedmetadata', () => {
    const totalTimeDisplay = document.getElementById('totalTime');
    totalTimeDisplay.textContent = formatTime(currentAudioPlayer.duration);
  });

  // Update progress bar and current time during playback
  currentAudioPlayer.addEventListener('timeupdate', updateProgressSlider);
}



// When audio is loaded, set the total time
currentAudioPlayer.addEventListener('loadedmetadata', () => {
  const totalTimeDisplay = document.getElementById('totalTime');
  totalTimeDisplay.innerText = formatTime(currentAudioPlayer.duration); // Display the total duration of the audio
});

// Update progress bar as audio plays
currentAudioPlayer.addEventListener('timeupdate', updateProgressSlider);

// Allow user to seek to a specific time
const progressSlider = document.getElementById('progressSlider');
progressSlider.addEventListener('input', (event) => {
  const seekTime = event.target.value;
  currentAudioPlayer.currentTime = seekTime;
});

// Helper function to format time in MM:SS
function formatTime(seconds) {
  const minutes = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${minutes}:${secs < 10 ? '0' : ''}${secs}`; // Leading zero for seconds
}


// Event listener for time update
if (currentAudioPlayer) {
  currentAudioPlayer.addEventListener('timeupdate', updateProgressSlider); // Update progress as audio plays
}


// Add event listener to update progress as audio plays
if (currentAudioPlayer) {
  currentAudioPlayer.addEventListener('timeupdate', updateProgressSlider); // Update progress in real-time
}
function showToast(message) {
  const toast = document.getElementById('toast');
  toast.innerHTML = message;
  toast.style.display = 'block';

  // Hide the toast after 3 seconds
  setTimeout(() => {
      toast.style.display = 'none';
  }, 3000);
}




function confirmClearBookmarks() {
  const userConfirmed = confirm('Are you sure you want to clear all bookmarks?');
  if (userConfirmed) {
    clearBookmarks();
    showToast('All bookmarks cleared!');
    // Update the bookmarks UI
    updateBookmarkedVersesContainer();
  } else {
    // Do nothing; bookmarks are not cleared
    showToast('Bookmarks not cleared.');
  }
}

function toggleHighContrast() {
  document.body.classList.toggle('high-contrast');
}



function saveBookmark() {
  const category = document.getElementById('categorySelect').value;
  const note = document.getElementById('noteInput').value;
  const verseReference = document.getElementById('verse-container').dataset.verseReference;
  const verseText = document.getElementById('verse').innerHTML;
  const translationText = document.getElementById('translation').innerHTML;

  const dateAdded = new Date().toLocaleString(); // e.g., "4/13/2025, 11:27:00 AM"

  if (!isVerseBookmarked(verseReference)) {
    bookmarkedVerses.push({
      verseReference,
      verseText,
      translationText,
      category,
      note,
      dateAdded
    });

    saveBookmarksToLocalStorage();
    showToast('Verse bookmarked successfully!');
  } else {
    showToast('Verse is already bookmarked!');
  }

  // Close the modal
  closeBookmarkModal();
}

async function showSuggestions(query) {
  if (query.length < 2) {
    // Hide suggestions if query is too short
    document.getElementById('suggestionsList').style.display = 'none';
    return;
  }

  // Fetch suggestions from the API or a local data source
  const suggestions = await fetchSuggestions(query);

  // Display suggestions
  const suggestionsList = document.getElementById('suggestionsList');
  suggestionsList.innerHTML = '';
  suggestions.forEach((suggestion) => {
    const listItem = document.createElement('li');
    listItem.textContent = suggestion;
    listItem.addEventListener('click', () => {
      document.getElementById('searchInput').value = suggestion;
      suggestionsList.style.display = 'none';
      performSearch();
    });
    suggestionsList.appendChild(listItem);
  });
  suggestionsList.style.display = 'block';
}
async function fetchSuggestions(query) {
  // For demonstration, we'll use a static list or simulate an API call
  const allKeywords = ['Mercy', 'Patience', 'Peace', 'Justice', 'Faith'];
  return allKeywords.filter((keyword) =>
    keyword.toLowerCase().includes(query.toLowerCase())
  );
}


// Hide suggestions when clicking outside
document.addEventListener('click', function (event) {
  const suggestionsList = document.getElementById('suggestionsList');
  if (!suggestionsList.contains(event.target)) {
    suggestionsList.style.display = 'none';
  }
});





let englishTranslationData = [];

async function fetchEnglishTranslationData() {
    try {
        const response = await axios.get('https://api.alquran.cloud/v1/quran/en.sahih');
        const surahs = response.data.data.surahs;
        surahs.forEach(surah => {
            surah.ayahs.forEach(ayah => {
                englishTranslationData.push({
                    number: ayah.number,
                    surahNumber: surah.number,
                    surahName: surah.englishName,
                    surahEnglishNameTranslation: surah.englishNameTranslation,
                    ayahNumber: ayah.numberInSurah,
                    text: ayah.text
                });
            });
        });
        document.getElementById('dataLoadingOverlay').style.display = 'none';
        console.log('English translation data loaded.');
    } catch (error) {
        console.error('Error fetching English translation data:', error);
    }
}

function toggleTranslation() {
  const translationElement = document.getElementById('translation');
  const secondTranslationElement = document.getElementById('second-translation');
  const translationArrow = document.getElementById('translationArrow');

  // Toggle the main translation
  const isShowing = translationElement.classList.toggle('show');

  // If second translation has content, mirror the state
  if (secondTranslationElement.innerHTML.trim() !== '') {
    if (isShowing) {
      secondTranslationElement.classList.add('show');
    } else {
      secondTranslationElement.classList.remove('show');
    }
  }

  translationArrow.innerHTML = isShowing ? '&#x25B2;' : '&#x25BC;';
}



const moodVerseMapping = {
  stressed: [2, 286, 94, 6, 65, 2, 45], // Surah Al-Baqarah, Al-Inshirah, At-Talaq
  happy: [14, 7, 93, 11, 55, 13], // Surah Ibrahim, Surah Duha, Ar-Rahman
  sad: [12, 86, 94, 5, 2, 153], // Surah Yusuf, Surah Ash-Sharh, Al-Baqarah
  grateful: [14, 7, 2, 152, 76, 11], // Surah Ibrahim, Al-Baqarah, Al-Insan
  fearful: [8, 33, 13, 28, 2, 286], // Surah Al-Anfal, Ar-Ra'd, Al-Baqarah
  angry: [3, 134, 42, 37, 16, 126], // Surah Al-Imran, Ash-Shura, An-Nahl
  hopeful: [94, 6, 29, 69, 19, 96], // Surah Ash-Sharh, Al-Ankabut, Maryam
  anxious: [13, 28, 2, 45, 9, 51], // Surah Ar-Ra'd, Al-Baqarah, At-Tawbah
  lonely: [2, 257, 50, 16], // Surah Al-Baqarah, Surah Qaf
  seeking_forgiveness: [39, 53, 3, 135, 15, 49], // Surah Az-Zumar, Al-Imran, Al-Hijr
  tired: [94, 5, 25, 63], // Surah Ash-Sharh, Surah Al-Furqan
  yearning_for_guidance: [29, 69, 2, 2], // Surah Al-Ankabut, Al-Baqarah
  uncertain: [2, 216, 17, 81], // Surah Al-Baqarah, Surah Al-Isra
};


async function fetchVerseByMood(mood) {
  if (!mood || !moodVerseMapping[mood]) {
    alert('Please select a valid mood.');
    return;
  }

  // Get a random verse number from the mood's verse list
  const verses = moodVerseMapping[mood];
  const randomIndex = Math.floor(Math.random() * verses.length);
  const verseNumber = verses[randomIndex];

  // Fetch and display the verse
  try {
    const verseData = await getVerseData(verseNumber);
    const translationData = await getTranslationData(verseNumber);
    updateVerseUI(verseData, translationData);
    setVerseReference(verseData.number);
    
    // Stop automatic verse changes
    stopVerseChangeTimer();
  } catch (error) {
    handleErrors(error, 'Error fetching verse by mood:');
  }
}
let userWallpapers = [];
let wallpaperChangeInterval = null;
let rotationIndex = 0;
let isRotating = false;
let predefinedWallpapers = ['wallpaper1.jpg', 'wallpaper2.jpg', 'wallpaper3.jpg']; // Predefined wallpaper URLs

// Function to populate the predefined wallpaper select dropdown
function populatePredefinedWallpapers() {
  const predefinedSelect = document.getElementById('predefinedWallpapers');
  predefinedSelect.innerHTML = ''; // Clear existing options

  // Add predefined wallpapers to the dropdown
  predefinedWallpapers.forEach((wallpaper, index) => {
    const option = document.createElement('option');
    option.value = wallpaper;
    option.text = `Predefined Wallpaper ${index + 1}`;
    predefinedSelect.appendChild(option);
  });

  // Add user uploaded wallpapers to the dropdown
  userWallpapers.forEach((wallpaper, index) => {
    const option = document.createElement('option');
    option.value = wallpaper;
    option.text = `Uploaded Wallpaper ${index + 1}`;
    predefinedSelect.appendChild(option);
  });
}

// Function to set a predefined wallpaper
function setPredefinedWallpaper(wallpaperUrl) {
  if (!wallpaperUrl) {
    console.error("Wallpaper URL is not valid.");
    return;
  }

  // Set the new wallpaper
  document.body.style.backgroundImage = `url('${wallpaperUrl}')`;
  document.body.style.backgroundSize = 'cover';
  document.body.style.backgroundPosition = 'center';

  // Stop wallpaper rotation if active
  if (wallpaperChangeInterval) {
    clearInterval(wallpaperChangeInterval);
  }

  console.log(`Wallpaper set to: ${wallpaperUrl}`);
}




// Function to set the selected wallpaper mode (still or rotation)
function changeWallpaperMode(mode) {
  if (mode === 'rotation') {
    startWallpaperRotation(); // Start wallpaper rotation
    document.getElementById('toggleRotationBtn').textContent = 'Stop Rotation';
  } else if (mode === 'still') {
    clearInterval(wallpaperChangeInterval); // Stop rotation for still mode
    document.getElementById('toggleRotationBtn').textContent = 'Start Rotation';
  }
}

function addUploadedWallpaperToDropdown(wallpaperUrl) {
  const dropdown = document.getElementById('predefinedWallpapers');

  // Check if the uploaded wallpaper is already in the dropdown
  const existingOptions = Array.from(dropdown.options).map(option => option.value);
  if (existingOptions.includes(wallpaperUrl)) {
    return;
  }

  // Add the new uploaded wallpaper as an option
  const newOption = document.createElement('option');
  newOption.value = wallpaperUrl;
  newOption.textContent = `Uploaded Wallpaper ${existingOptions.length - 1}`; // Name dynamically
  dropdown.appendChild(newOption);
}





// Function to start automatic wallpaper rotation
function startWallpaperRotation() {
  if (userWallpapers.length > 0) {
    clearInterval(wallpaperChangeInterval); // Clear any previous intervals

    wallpaperChangeInterval = setInterval(() => {
      document.body.style.backgroundImage = `url('${userWallpapers[rotationIndex]}')`;
      document.body.style.backgroundSize = 'cover'; // Ensure the image covers the background
      document.body.style.backgroundPosition = 'center'; // Center the image
      rotationIndex = (rotationIndex + 1) % userWallpapers.length; // Loop back to the first wallpaper
    }, 10000); // Change wallpaper every 10 seconds
  }
}
async function populateSurahDropdown() {
  try {
    const response = await axios.get('https://api.alquran.cloud/v1/surah');
    const surahs = response.data.data;
    const surahSelect = document.getElementById('surahSelect');

    surahs.forEach(surah => {
      const option = document.createElement('option');
      option.value = surah.number;
      option.text = `${surah.number}. ${surah.englishName} (${surah.name})`;
      surahSelect.appendChild(option);
    });
  } catch (error) {
    console.error('Error fetching Surah list:', error);
  }
}
async function populateEditionDropdown() {
  try {
    const response = await axios.get('https://api.alquran.cloud/v1/edition');
    const editions = response.data.data;
    const editionSelect = document.getElementById('editionSelect');
    const secondEditionSelect = document.getElementById('secondEditionSelect');

    // Clear existing options
    editionSelect.innerHTML = '';
    secondEditionSelect.innerHTML = '<option value="">None</option>';

    editions.forEach(edition => {
      if (edition.format === 'text' && (edition.type === 'translation' || edition.type === 'quran')) {
        const option = document.createElement('option');
        option.value = edition.identifier;
        option.text = `${edition.language.toUpperCase()} - ${edition.name}`;
        editionSelect.appendChild(option);

        const secondOption = option.cloneNode(true);
        secondEditionSelect.appendChild(secondOption);
      }
    });
  } catch (error) {
    console.error('Error fetching editions:', error);
  }
}


function changeEdition(editionIdentifier) {
  TRANSLATION_EDITIONS = editionIdentifier;
  localStorage.setItem('selectedEdition', editionIdentifier);

  const verseContainer = document.getElementById('verse-container');
  const currentOverallVerseNumber = verseContainer.dataset.overallVerseNumber;

  if (currentOverallVerseNumber) {
    fetchVerse(parseInt(currentOverallVerseNumber));
  }
}


document.getElementById('surahSelect').addEventListener('change', function() {
  const selectedSurah = this.value;
  if (selectedSurah === 'all') {
    // Fetch a random verse
    fetchVerse();
  } else {
    // Fetch the first verse of the selected surah
    fetchVerseByNumber(`${selectedSurah}:1`);
  }
});
const API_URL = 'https://api.quran.com/api/v4/search';

async function performSearch() {
  const query = document.getElementById('searchInput').value.trim();

  if (!query) {
    alert('Please enter a search query.');
    return;
  }

  // Check if the query matches the surah:ayah format (e.g., "2:255")
  if (isSurahAyahFormat(query)) {
    const [surah, ayah] = query.split(':').map(Number);

    // Validate Surah and Ayah numbers
    if (!isNaN(surah) && !isNaN(ayah) && surah > 0 && ayah > 0) {
      try {
        await displayVerseByKey(query); // Display the verse directly
        return; // Exit the function
      } catch (error) {
        console.error('Error fetching verse by key:', error);
        alert('Error fetching the verse. Please try again.');
        return;
      }
    } else {
      alert('Invalid Surah:Ayah format. Please use the correct format, e.g., "2:255".');
      return;
    }
  }

  // For other queries, proceed with normal search
  const language = 'en'; // You can adjust this if you want to support other languages
  const size = 20; // Default number of results per page
  const page = 1; // You can set up pagination later

  // Show loading spinner
  document.getElementById('loadingSpinner').style.display = 'block';

  try {
    const response = await fetch(
      `${API_URL}?q=${encodeURIComponent(query)}&size=${size}&page=${page}&language=${language}`
    );
    const data = await response.json();

    if (data.search && data.search.results.length > 0) {
      displaySearchResults(data.search.results);
    } else {
      alert('No results found.');
    }
  } catch (error) {
    console.error('Error fetching search results:', error);
    alert('Error fetching search results.');
  } finally {
    document.getElementById('loadingSpinner').style.display = 'none';
  }
}


function displaySearchResults(results) {
  const searchResultsList = document.getElementById('searchResultsList');
  searchResultsList.innerHTML = ''; // Clear previous results

  results.forEach(result => {
    const listItem = document.createElement('li');
    listItem.innerHTML = `
      <strong>${result.verse_key}</strong><br>
      <p>${result.text}</p>
    `;
    listItem.addEventListener('click', () => {
      handleVerseSelection(result.verse_key); // Call the new function
    });
    searchResultsList.appendChild(listItem);
  });

  document.getElementById('searchResultsContainer').style.display = 'block';
}


async function displayVerseByKey(verseKey) {
  try {
    // Split the verseKey (e.g., "2:255") into surah and ayah numbers
    const [surah, ayah] = verseKey.split(':');

    // Fetch the verse details from Quran.com API
    const verseData = await getVerseDataBySurahAyah(surah, ayah);
    const translationData = await getTranslationDataBySurahAyah(surah, ayah);

    // Update the main verse display with the fetched verse and translation
    updateVerseUI(verseData, translationData);

    // Set the verse reference so that the page state is updated
    setVerseReference(`${surah}:${ayah}`);
  } catch (error) {
    console.error('Error fetching verse details:', error);
    alert('Error fetching verse details.');
  }
}
let recognition;

if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
  // Check for browser support
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SpeechRecognition();
  
  // Set recognition properties
  recognition.lang = 'ar-SA' // You can set this to any language you want to support
  recognition.interimResults = false; // Do not display interim results
  recognition.maxAlternatives = 1; // Only return one alternative
  
  // Voice search button event
  document.getElementById('voiceSearchButton').addEventListener('click', () => {
    recognition.start(); // Start voice recognition
    console.log('Voice search activated, speak now...');
  });
  
  // Handle speech recognition results
  recognition.addEventListener('result', (event) => {
    const transcript = event.results[0][0].transcript;
6
    const verseElement = document.createElement('div');
    verseElement.className = 'bookmarkedVerse';
    verseElement.innerHTML = `
      <strong>${verse.verseText}</strong><br>
      ${verse.translationText}<br>
      <em>Category: ${verse.category}</em><br>
      <p>Note: ${verse.note}</p>
    `;
    verseElement.addEventListener('click', () => {
      displayBookmarkedVerse(verse.verseReference);
    });
    container.appendChild(verseElement);
  });
}

function changeSecondEdition(editionIdentifier) {
  SECOND_TRANSLATION_EDITIONS = editionIdentifier;

  const verseContainer = document.getElementById('verse-container');
  const currentOverallVerseNumber = verseContainer.dataset.overallVerseNumber;
  
  // If no overall verse number is available, do not call fetchVerse
  if (currentOverallVerseNumber) {
    // Convert it to an integer
    const verseNum = parseInt(currentOverallVerseNumber, 10);

    // Ensure we have a valid number before calling fetchVerse
    if (!isNaN(verseNum) && verseNum > 0 && verseNum <= 6236) {
      fetchVerse(verseNum);
    } else {
      console.error('Invalid overall verse number:', currentOverallVerseNumber);
    }
  }
  else {
    // If you get here, it means updateVerseUI hasn't set the dataset yet.
    // Possibly fetch a default verse or handle the scenario gracefully.
    console.warn('No verse currently loaded to re-fetch after changing second edition.');
  }
}







function updateSecondTranslationUI(text) {
  const secondTranslationElement = document.getElementById('second-translation');
  if (text) {
    secondTranslationElement.style.display = 'block';
    secondTranslationElement.innerHTML = text;
  } else {
    secondTranslationElement.style.display = 'none';
    secondTranslationElement.innerHTML = '';
  }
}


function handleVerseSelection(verseKey) {
  // Parse the verse key (e.g., "2:255") into surah and ayah numbers
  const [surahNumber, ayahNumber] = verseKey.split(':').map(Number);

  // Validate the parsed numbers
  if (isNaN(surahNumber) || isNaN(ayahNumber)) {
    alert("Invalid verse key.");
    return;
  }

  // Fetch and display the verse by the key
  displayVerseByNumber(`${surahNumber}:${ayahNumber}`);
}

function toggleSequentialPlayback() {
  // Toggle the sequential playback state
  isSequentialPlayback = !isSequentialPlayback;

  // Provide feedback to the user (optional)
  const message = isSequentialPlayback
    ? "Sequential playback enabled."
    : "Sequential playback disabled.";
  showToast(message);

  // Restart the verse change timer if sequential playback is toggled on
  if (isSequentialPlayback) {
    startVerseChangeTimer();
  } else {
    stopVerseChangeTimer();
  }
}





function closeMenuOnClickOutside() {
  // Add a click event listener to the entire document
  document.addEventListener('click', (event) => {
    const menu = document.getElementById('menuItems'); // The menu element
    const menuArrow = document.getElementById('menuArrow'); // The menu arrow element

    // Check if the menu is active and the click happened outside of the menu or menu arrow
    if (menu.classList.contains('active') && !menu.contains(event.target) && !menuArrow.contains(event.target)) {
      menu.classList.remove('active'); // Close the menu
    }
  });
}




function toggleVerseChange() {
  const toggleButton = document.getElementById('toggleAutoChangeButton');
  const toggleIcon = document.getElementById('autoChangeIcon');
  const toggleTooltip = document.getElementById('autoChangeTooltip');

  if (verseChangeTimer) {
    // If the timer is active, stop it
    clearInterval(verseChangeTimer);
    verseChangeTimer = null;

    // Update the button and tooltip to indicate stopping
    toggleIcon.src = 'https://cdn-icons-png.flaticon.com/512/5192/5192715.png'; // Play icon
    toggleTooltip.textContent = 'Start Auto Change';
    showToast('Automatic verse change stopped.');
  } else {
    // If the timer is inactive, start it
    startVerseChangeTimer();

    // Update the button and tooltip to indicate starting
    toggleIcon.src = 'https://cdn-icons-png.flaticon.com/512/5192/5192719.png'; // Stop icon
    toggleTooltip.textContent = 'Stop Auto Change';
    showToast('Automatic verse change started.');
  }
}
function addNewCategory() {
  const newCategoryInput = document.getElementById('newCategoryInput');
  const categorySelect = document.getElementById('categorySelect');

  const newCategory = newCategoryInput.value.trim(); // Get the new category value
  if (!newCategory) {
    alert('Please enter a valid category name.');
    return;
  }

  // Check if the category already exists
  const existingCategories = Array.from(categorySelect.options).map(option => option.value);
  if (existingCategories.includes(newCategory)) {
    alert('This category already exists.');
    return;
  }

  // Add the new category to the dropdown
  const newOption = document.createElement('option');
  newOption.value = newCategory;
  newOption.textContent = newCategory.charAt(0).toUpperCase() + newCategory.slice(1); // Capitalize first letter
  categorySelect.appendChild(newOption);

  // Clear the input field and notify the user
  newCategoryInput.value = '';
  alert('New category added successfully!');
}
function seekAudio(seekValue) {
  if (currentAudioPlayer) {
    const seekTime = parseFloat(seekValue); // Convert the slider value to a number
    if (!isNaN(seekTime) && currentAudioPlayer.duration) {
      // Ensure the seek time is within the audio duration
      currentAudioPlayer.currentTime = Math.min(seekTime, currentAudioPlayer.duration);
    }
  } else {
    alert("Audio is not currently loaded or playing.");
  }
}
function addUploadedWallpaperToDropdown(wallpaperUrl) {
  const dropdown = document.getElementById('predefinedWallpapers');

  // Check if the uploaded wallpaper is already in the dropdown
  const existingOptions = Array.from(dropdown.options).map(option => option.value);
  if (existingOptions.includes(wallpaperUrl)) {
    console.log("Uploaded wallpaper is already in the dropdown.");
    return;
  }

  // Add the new uploaded wallpaper as an option
  const newOption = document.createElement('option');
  newOption.value = wallpaperUrl;
  newOption.textContent = `Uploaded Wallpaper ${existingOptions.length - 1}`; // Name dynamically
  dropdown.appendChild(newOption);

  console.log("Uploaded wallpaper added to the dropdown.");
}
function hideSearchResults() {
  const searchResultsContainer = document.getElementById('searchResultsContainer');
  if (searchResultsContainer) {
    searchResultsContainer.style.display = 'none'; // Hide the container
  } else {
    console.error("Search results container not found.");
  }
}


</script>
</body>
</html>
